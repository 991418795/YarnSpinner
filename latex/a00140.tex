\hypertarget{a00140}{\section{Yarn.\-Program Class Reference}
\label{a00140}\index{Yarn.\-Program@{Yarn.\-Program}}
}


Collaboration diagram for Yarn.\-Program\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=186pt]{a00630}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{a00140_a977d1ed02e3f6f39d30dfea1663e7927}{Load\-Strings} (Dictionary$<$ string, string $>$ new\-Strings)
\begin{DoxyCompactList}\small\item\em Loads a new string table into the program. \end{DoxyCompactList}\item 
string \hyperlink{a00140_a9baf491479375aa8c3aa2b0c31cf0932}{Register\-String} (string the\-String, string node\-Name, string line\-I\-D, int line\-Number, bool localisable)
\item 
string \hyperlink{a00140_a14737b93594c4aab25c59cb0a3c918f7}{Get\-String} (string key)
\item 
string \hyperlink{a00140_a2f5bb468ce53eb7bbe647e3c11ddbb61}{Dump\-Code} (\hyperlink{a00123}{Library} l)
\item 
string \hyperlink{a00140_aad8029f37832ff1985fad6a31e51afd8}{Get\-Text\-For\-Node} (string node\-Name)
\item 
I\-Enumerable$<$ string $>$ \hyperlink{a00140_a116312a32b20bc18e09f90c9c92a079f}{Get\-Tags\-For\-Node} (string node\-Name)
\item 
void \hyperlink{a00140_afd3385ca1f7589b3b9dae3646e4fee84}{Include} (\hyperlink{a00140}{Program} other\-Program)
\end{DoxyCompactItemize}
\subsection*{Package Attributes}
\begin{DoxyCompactItemize}
\item 
Dictionary$<$ string, string $>$ \hyperlink{a00140_a59263e00cecfe36d9881b4c30b048f09}{strings} = new Dictionary$<$string, string$>$()
\item 
Dictionary$<$ string, \hyperlink{a00125}{Line\-Info} $>$ \hyperlink{a00140_a0d4da395947767b4a1eaaff8a9842adc}{line\-Info} = new Dictionary$<$string, \hyperlink{a00125}{Line\-Info}$>$()
\item 
Dictionary$<$ string, \hyperlink{a00050_a00354}{Node} $>$ \hyperlink{a00140_a3f4928a577c88263ad016be259b175c4}{nodes} = new Dictionary$<$string, \hyperlink{a00050_a00354}{Node}$>$()
\end{DoxyCompactItemize}
\subsection*{Properties}
\begin{DoxyCompactItemize}
\item 
Dictionary$<$ string, string $>$ \hyperlink{a00140_aa8fedbfceaf931d1da3f600eaab6ae87}{untagged\-Strings}\hspace{0.3cm}{\ttfamily  \mbox{[}get\mbox{]}}
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{a00140_a8ef1d10094ef00311aade6715ba78ec7}{string\-Count} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 47 of file Program.\-cs.



\subsection{Member Function Documentation}
\hypertarget{a00140_a2f5bb468ce53eb7bbe647e3c11ddbb61}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Dump\-Code@{Dump\-Code}}
\index{Dump\-Code@{Dump\-Code}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Dump\-Code}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Dump\-Code (
\begin{DoxyParamCaption}
\item[{{\bf Library}}]{l}
\end{DoxyParamCaption}
)}}\label{a00140_a2f5bb468ce53eb7bbe647e3c11ddbb61}


Definition at line 123 of file Program.\-cs.



References Yarn.\-Program.\-line\-Info, Yarn.\-Program.\-nodes, and Yarn.\-Program.\-strings.


\begin{DoxyCode}
124         \{
125 
126             var sb = \textcolor{keyword}{new} System.Text.StringBuilder();
127 
128             \textcolor{keywordflow}{foreach} (var entry \textcolor{keywordflow}{in} \hyperlink{a00140_a3f4928a577c88263ad016be259b175c4}{nodes})
129             \{
130                 sb.AppendLine(\textcolor{stringliteral}{"Node "} + entry.Key + \textcolor{stringliteral}{":"});
131 
132                 \textcolor{keywordtype}{int} instructionCount = 0;
133                 \textcolor{keywordflow}{foreach} (var instruction \textcolor{keywordflow}{in} entry.Value.instructions)
134                 \{
135                     \textcolor{keywordtype}{string} instructionText;
136 
137                     \textcolor{keywordflow}{if} (instruction.operation == \hyperlink{a00050_ad5dfb6ee68ca7469623ad3e459f98894}{ByteCode}.Label)
138                     \{
139                         instructionText = instruction.ToString(\textcolor{keyword}{this}, l);
140                     \}
141                     \textcolor{keywordflow}{else}
142                     \{
143                         instructionText = \textcolor{stringliteral}{"    "} + instruction.ToString(\textcolor{keyword}{this}, l);
144                     \}
145 
146                     \textcolor{keywordtype}{string} preface;
147 
148                     \textcolor{keywordflow}{if} (instructionCount % 5 == 0 || instructionCount == entry.Value.instructions.Count - 1
      )
149                     \{
150                         preface = string.Format(CultureInfo.InvariantCulture, \textcolor{stringliteral}{"\{0,6\}   "}, instructionCount)
      ;
151                     \}
152                     \textcolor{keywordflow}{else}
153                     \{
154                         preface = string.Format(CultureInfo.InvariantCulture, \textcolor{stringliteral}{"\{0,6\}   "}, \textcolor{stringliteral}{" "});
155                     \}
156 
157                     sb.AppendLine(preface + instructionText);
158 
159                     instructionCount++;
160                 \}
161 
162                 sb.AppendLine();
163             \}
164 
165             sb.AppendLine(\textcolor{stringliteral}{"String table:"});
166 
167             \textcolor{keywordflow}{foreach} (var entry \textcolor{keywordflow}{in} \hyperlink{a00140_a59263e00cecfe36d9881b4c30b048f09}{strings})
168             \{
169                 var \hyperlink{a00140_a0d4da395947767b4a1eaaff8a9842adc}{lineInfo} = this.lineInfo[entry.Key];
170 
171                 sb.AppendLine(string.Format(CultureInfo.InvariantCulture, \textcolor{stringliteral}{"\{0\}: \{1\} (\{2\}:\{3\})"}, entry.Key, 
      entry.Value, lineInfo.nodeName, lineInfo.lineNumber));
172             \}
173 
174             \textcolor{keywordflow}{return} sb.ToString();
175         \}
\end{DoxyCode}
\hypertarget{a00140_a14737b93594c4aab25c59cb0a3c918f7}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Get\-String@{Get\-String}}
\index{Get\-String@{Get\-String}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Get\-String}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Get\-String (
\begin{DoxyParamCaption}
\item[{string}]{key}
\end{DoxyParamCaption}
)}}\label{a00140_a14737b93594c4aab25c59cb0a3c918f7}


Definition at line 116 of file Program.\-cs.


\begin{DoxyCode}
117         \{
118             \textcolor{keywordtype}{string} value = null;
119             strings.TryGetValue(key, out value);
120             \textcolor{keywordflow}{return} value;
121         \}
\end{DoxyCode}
\hypertarget{a00140_a116312a32b20bc18e09f90c9c92a079f}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Get\-Tags\-For\-Node@{Get\-Tags\-For\-Node}}
\index{Get\-Tags\-For\-Node@{Get\-Tags\-For\-Node}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Get\-Tags\-For\-Node}]{\setlength{\rightskip}{0pt plus 5cm}I\-Enumerable$<$string$>$ Yarn.\-Program.\-Get\-Tags\-For\-Node (
\begin{DoxyParamCaption}
\item[{string}]{node\-Name}
\end{DoxyParamCaption}
)}}\label{a00140_a116312a32b20bc18e09f90c9c92a079f}


Definition at line 182 of file Program.\-cs.



References Yarn.\-Program.\-nodes.


\begin{DoxyCode}
183         \{
184             \textcolor{keywordflow}{return} \hyperlink{a00140_a3f4928a577c88263ad016be259b175c4}{nodes}[nodeName].tags;
185         \}
\end{DoxyCode}
\hypertarget{a00140_aad8029f37832ff1985fad6a31e51afd8}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Get\-Text\-For\-Node@{Get\-Text\-For\-Node}}
\index{Get\-Text\-For\-Node@{Get\-Text\-For\-Node}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Get\-Text\-For\-Node}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Get\-Text\-For\-Node (
\begin{DoxyParamCaption}
\item[{string}]{node\-Name}
\end{DoxyParamCaption}
)}}\label{a00140_aad8029f37832ff1985fad6a31e51afd8}


Definition at line 177 of file Program.\-cs.



References Yarn.\-Program.\-nodes.


\begin{DoxyCode}
178         \{
179             \textcolor{keywordflow}{return} this.GetString(\hyperlink{a00140_a3f4928a577c88263ad016be259b175c4}{nodes}[nodeName].sourceTextStringID);
180         \}
\end{DoxyCode}
\hypertarget{a00140_afd3385ca1f7589b3b9dae3646e4fee84}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Include@{Include}}
\index{Include@{Include}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Include}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Program.\-Include (
\begin{DoxyParamCaption}
\item[{{\bf Program}}]{other\-Program}
\end{DoxyParamCaption}
)}}\label{a00140_afd3385ca1f7589b3b9dae3646e4fee84}


Definition at line 187 of file Program.\-cs.



References Yarn.\-Program.\-nodes, and Yarn.\-Program.\-strings.


\begin{DoxyCode}
188         \{
189             \textcolor{keywordflow}{foreach} (var otherNodeName \textcolor{keywordflow}{in} otherProgram.nodes)
190             \{
191 
192                 \textcolor{keywordflow}{if} (\hyperlink{a00140_a3f4928a577c88263ad016be259b175c4}{nodes}.ContainsKey(otherNodeName.Key))
193                 \{
194                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} InvalidOperationException(\textcolor{keywordtype}{string}.Format(CultureInfo.CurrentCulture, \textcolor{stringliteral}{"This
       program already contains a node named \{0\}"}, otherNodeName.Key));
195                 \}
196 
197                 \hyperlink{a00140_a3f4928a577c88263ad016be259b175c4}{nodes}[otherNodeName.Key] = otherNodeName.Value;
198             \}
199 
200             \textcolor{keywordflow}{foreach} (var otherString \textcolor{keywordflow}{in} otherProgram.strings)
201             \{
202 
203                 \textcolor{keywordflow}{if} (\hyperlink{a00140_a3f4928a577c88263ad016be259b175c4}{nodes}.ContainsKey(otherString.Key))
204                 \{
205                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} InvalidOperationException(\textcolor{keywordtype}{string}.Format(CultureInfo.CurrentCulture, \textcolor{stringliteral}{"This
       program already contains a string with key \{0\}"}, otherString.Key));
206                 \}
207 
208                 \hyperlink{a00140_a59263e00cecfe36d9881b4c30b048f09}{strings}[otherString.Key] = otherString.Value;
209             \}
210         \}
\end{DoxyCode}
\hypertarget{a00140_a977d1ed02e3f6f39d30dfea1663e7927}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Load\-Strings@{Load\-Strings}}
\index{Load\-Strings@{Load\-Strings}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Load\-Strings}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Program.\-Load\-Strings (
\begin{DoxyParamCaption}
\item[{Dictionary$<$ string, string $>$}]{new\-Strings}
\end{DoxyParamCaption}
)}}\label{a00140_a977d1ed02e3f6f39d30dfea1663e7927}


Loads a new string table into the program. 

The string table is merged with any existing strings, with the new table taking precedence over the old. 

Definition at line 86 of file Program.\-cs.



References Yarn.\-Program.\-strings.


\begin{DoxyCode}
87         \{
88             \textcolor{keywordflow}{foreach} (var entry \textcolor{keywordflow}{in} newStrings)
89             \{
90                 \hyperlink{a00140_a59263e00cecfe36d9881b4c30b048f09}{strings}[entry.Key] = entry.Value;
91             \}
92         \}
\end{DoxyCode}
\hypertarget{a00140_a9baf491479375aa8c3aa2b0c31cf0932}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Register\-String@{Register\-String}}
\index{Register\-String@{Register\-String}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Register\-String}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Register\-String (
\begin{DoxyParamCaption}
\item[{string}]{the\-String, }
\item[{string}]{node\-Name, }
\item[{string}]{line\-I\-D, }
\item[{int}]{line\-Number, }
\item[{bool}]{localisable}
\end{DoxyParamCaption}
)}}\label{a00140_a9baf491479375aa8c3aa2b0c31cf0932}


Definition at line 94 of file Program.\-cs.



References Yarn.\-Program.\-string\-Count.


\begin{DoxyCode}
95         \{
96 
97             \textcolor{keywordtype}{string} key;
98 
99             \textcolor{keywordflow}{if} (lineID == null)
100                 key = string.Format(CultureInfo.InvariantCulture, \textcolor{stringliteral}{"\{0\}-\{1\}"}, nodeName, 
      \hyperlink{a00140_a8ef1d10094ef00311aade6715ba78ec7}{stringCount}++);
101             \textcolor{keywordflow}{else}
102                 key = lineID;
103 
104             \textcolor{comment}{// It's not in the list; append it}
105             strings.Add(key, theString);
106 
107             \textcolor{keywordflow}{if} (localisable)
108             \{
109                 \textcolor{comment}{// Additionally, keep info about this string around}
110                 lineInfo.Add(key, \textcolor{keyword}{new} LineInfo(nodeName, lineNumber));
111             \}
112 
113             \textcolor{keywordflow}{return} key;
114         \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{a00140_a0d4da395947767b4a1eaaff8a9842adc}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!line\-Info@{line\-Info}}
\index{line\-Info@{line\-Info}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{line\-Info}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string, {\bf Line\-Info}$>$ Yarn.\-Program.\-line\-Info = new Dictionary$<$string, {\bf Line\-Info}$>$()\hspace{0.3cm}{\ttfamily [package]}}}\label{a00140_a0d4da395947767b4a1eaaff8a9842adc}


Definition at line 51 of file Program.\-cs.



Referenced by Yarn.\-Program.\-Dump\-Code().

\hypertarget{a00140_a3f4928a577c88263ad016be259b175c4}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!nodes@{nodes}}
\index{nodes@{nodes}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{nodes}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string, {\bf Node}$>$ Yarn.\-Program.\-nodes = new Dictionary$<$string, {\bf Node}$>$()\hspace{0.3cm}{\ttfamily [package]}}}\label{a00140_a3f4928a577c88263ad016be259b175c4}


Definition at line 53 of file Program.\-cs.



Referenced by Yarn.\-Program.\-Dump\-Code(), Yarn.\-Dialogue.\-Get\-Tags\-For\-All\-Nodes(), Yarn.\-Program.\-Get\-Tags\-For\-Node(), Yarn.\-Dialogue.\-Get\-Tags\-For\-Node(), Yarn.\-Dialogue.\-Get\-Text\-For\-All\-Nodes(), Yarn.\-Program.\-Get\-Text\-For\-Node(), Yarn.\-Dialogue.\-Get\-Text\-For\-Node(), Yarn.\-Program.\-Include(), Yarn.\-Dialogue.\-Node\-Exists(), and Yarn.\-Virtual\-Machine.\-Set\-Node().

\hypertarget{a00140_a8ef1d10094ef00311aade6715ba78ec7}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!string\-Count@{string\-Count}}
\index{string\-Count@{string\-Count}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{string\-Count}]{\setlength{\rightskip}{0pt plus 5cm}int Yarn.\-Program.\-string\-Count = 0\hspace{0.3cm}{\ttfamily [private]}}}\label{a00140_a8ef1d10094ef00311aade6715ba78ec7}


Definition at line 80 of file Program.\-cs.



Referenced by Yarn.\-Program.\-Register\-String().

\hypertarget{a00140_a59263e00cecfe36d9881b4c30b048f09}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!strings@{strings}}
\index{strings@{strings}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{strings}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string, string$>$ Yarn.\-Program.\-strings = new Dictionary$<$string, string$>$()\hspace{0.3cm}{\ttfamily [package]}}}\label{a00140_a59263e00cecfe36d9881b4c30b048f09}


Definition at line 50 of file Program.\-cs.



Referenced by Yarn.\-Program.\-Dump\-Code(), Yarn.\-Program.\-Include(), and Yarn.\-Program.\-Load\-Strings().



\subsection{Property Documentation}
\hypertarget{a00140_aa8fedbfceaf931d1da3f600eaab6ae87}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!untagged\-Strings@{untagged\-Strings}}
\index{untagged\-Strings@{untagged\-Strings}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{untagged\-Strings}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string, string$>$ Yarn.\-Program.\-untagged\-Strings\hspace{0.3cm}{\ttfamily [get]}, {\ttfamily [package]}}}\label{a00140_aa8fedbfceaf931d1da3f600eaab6ae87}


Definition at line 64 of file Program.\-cs.



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
Yarn\-Spinner/\hyperlink{a00292}{Program.\-cs}\end{DoxyCompactItemize}
