\hypertarget{a00067}{\section{Yarn.\-Program Class Reference}
\label{a00067}\index{Yarn.\-Program@{Yarn.\-Program}}
}


Collaboration diagram for Yarn.\-Program\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{dd/df4/a00193}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
string \hyperlink{a00067_a13c9b747b37e404e2d0713468b2a78ff}{Register\-String} (string the\-String, string for\-Node)
\item 
string \hyperlink{a00067_a14737b93594c4aab25c59cb0a3c918f7}{Get\-String} (string key)
\item 
string \hyperlink{a00067_a2f5bb468ce53eb7bbe647e3c11ddbb61}{Dump\-Code} (\hyperlink{a00049}{Library} l)
\item 
string \hyperlink{a00067_aad8029f37832ff1985fad6a31e51afd8}{Get\-Text\-For\-Node} (string node\-Name)
\item 
void \hyperlink{a00067_afd3385ca1f7589b3b9dae3646e4fee84}{Include} (\hyperlink{a00067}{Program} other\-Program)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
Dictionary$<$ string, string $>$ \hyperlink{a00067_a91518fda7e41bf573f66c6946dd3b4cb}{strings} = new Dictionary$<$string, string$>$ ()
\item 
Dictionary$<$ string, \hyperlink{a00026_de/d38/a00160}{Node} $>$ \hyperlink{a00067_a3f4928a577c88263ad016be259b175c4}{nodes} = new Dictionary$<$string, \hyperlink{a00026_de/d38/a00160}{Node}$>$ ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{a00067_a8ef1d10094ef00311aade6715ba78ec7}{string\-Count} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Member Function Documentation}
\hypertarget{a00067_a2f5bb468ce53eb7bbe647e3c11ddbb61}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Dump\-Code@{Dump\-Code}}
\index{Dump\-Code@{Dump\-Code}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Dump\-Code}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Dump\-Code (
\begin{DoxyParamCaption}
\item[{{\bf Library}}]{l}
\end{DoxyParamCaption}
)}}\label{a00067_a2f5bb468ce53eb7bbe647e3c11ddbb61}

\begin{DoxyCode}
32                                           \{
33 
34             var sb = \textcolor{keyword}{new} System.Text.StringBuilder ();
35 
36             \textcolor{keywordflow}{foreach} (var entry \textcolor{keywordflow}{in} \hyperlink{a00067_a3f4928a577c88263ad016be259b175c4}{nodes}) \{
37                 sb.AppendLine (\textcolor{stringliteral}{"Node "} + entry.Key + \textcolor{stringliteral}{":"});
38 
39                 \textcolor{keywordtype}{int} instructionCount = 0;
40                 \textcolor{keywordflow}{foreach} (var instruction \textcolor{keywordflow}{in} entry.Value.instructions) \{
41                     \textcolor{keywordtype}{string} instructionText;
42 
43                     \textcolor{keywordflow}{if} (instruction.operation == \hyperlink{a00026_ad5dfb6ee68ca7469623ad3e459f98894}{ByteCode}.Label) \{
44                         instructionText = instruction.ToString (\textcolor{keyword}{this}, l);
45                     \} \textcolor{keywordflow}{else} \{
46                         instructionText = \textcolor{stringliteral}{"    "} + instruction.ToString (\textcolor{keyword}{this}, l);
47                     \}
48 
49                     \textcolor{keywordtype}{string} preface;
50 
51                     \textcolor{keywordflow}{if} (instructionCount % 5 == 0 || instructionCount == entry.Value.instructions.Count - 1
      ) \{
52                         preface = string.Format (\textcolor{stringliteral}{"\{0,6\}   "}, instructionCount);
53                     \} \textcolor{keywordflow}{else} \{
54                         preface = string.Format (\textcolor{stringliteral}{"\{0,6\}   "}, \textcolor{stringliteral}{" "});
55                     \}
56 
57                     sb.AppendLine (preface + instructionText);
58 
59                     instructionCount++;
60                 \}
61 
62                 \textcolor{comment}{/* sb.AppendLine ();}
63 \textcolor{comment}{                sb.AppendLine ("Label table:");}
64 \textcolor{comment}{}
65 \textcolor{comment}{                foreach (var label in entry.Value.labels) \{}
66 \textcolor{comment}{                    sb.AppendLine (string.Format ("\{0,12\} : \{1\}", label.Key, label.Value));}
67 \textcolor{comment}{                \}*/}
68 
69                 sb.AppendLine ();
70             \}
71 
72             sb.AppendLine (\textcolor{stringliteral}{"String table:"});
73 
74             \textcolor{keywordtype}{int} \hyperlink{a00067_a8ef1d10094ef00311aade6715ba78ec7}{stringCount} = 0;
75             \textcolor{keywordflow}{foreach} (var entry \textcolor{keywordflow}{in} \hyperlink{a00067_a91518fda7e41bf573f66c6946dd3b4cb}{strings}) \{
76                 sb.AppendLine(string.Format(\textcolor{stringliteral}{"\{0, 4\}: \{1\}"}, \hyperlink{a00067_a8ef1d10094ef00311aade6715ba78ec7}{stringCount}, entry));
77                 stringCount++;
78             \}
79 
80 
81             \textcolor{keywordflow}{return} sb.ToString ();
82         \}
\end{DoxyCode}
\hypertarget{a00067_a14737b93594c4aab25c59cb0a3c918f7}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Get\-String@{Get\-String}}
\index{Get\-String@{Get\-String}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Get\-String}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Get\-String (
\begin{DoxyParamCaption}
\item[{string}]{key}
\end{DoxyParamCaption}
)}}\label{a00067_a14737b93594c4aab25c59cb0a3c918f7}

\begin{DoxyCode}
26                                             \{
27             \textcolor{keywordtype}{string} value = null;
28             strings.TryGetValue (key, out value);
29             \textcolor{keywordflow}{return} value;
30         \}
\end{DoxyCode}
\hypertarget{a00067_aad8029f37832ff1985fad6a31e51afd8}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Get\-Text\-For\-Node@{Get\-Text\-For\-Node}}
\index{Get\-Text\-For\-Node@{Get\-Text\-For\-Node}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Get\-Text\-For\-Node}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Get\-Text\-For\-Node (
\begin{DoxyParamCaption}
\item[{string}]{node\-Name}
\end{DoxyParamCaption}
)}}\label{a00067_aad8029f37832ff1985fad6a31e51afd8}

\begin{DoxyCode}
84                                                       \{
85             \textcolor{keywordflow}{return} this.GetString (\hyperlink{a00067_a3f4928a577c88263ad016be259b175c4}{nodes} [nodeName].sourceTextStringID);
86         \}
\end{DoxyCode}
\hypertarget{a00067_afd3385ca1f7589b3b9dae3646e4fee84}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Include@{Include}}
\index{Include@{Include}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Include}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Program.\-Include (
\begin{DoxyParamCaption}
\item[{{\bf Program}}]{other\-Program}
\end{DoxyParamCaption}
)}}\label{a00067_afd3385ca1f7589b3b9dae3646e4fee84}

\begin{DoxyCode}
89         \{
90             \textcolor{keywordflow}{foreach} (var otherNodeName \textcolor{keywordflow}{in} otherProgram.nodes) \{
91 
92                 \textcolor{keywordflow}{if} (\hyperlink{a00067_a3f4928a577c88263ad016be259b175c4}{nodes}.ContainsKey(otherNodeName.Key)) \{
93                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} InvalidOperationException (\textcolor{keywordtype}{string}.Format (\textcolor{stringliteral}{"This program already contains a
       node named \{0\}"}, otherNodeName.Key));
94                 \}
95 
96                 \hyperlink{a00067_a3f4928a577c88263ad016be259b175c4}{nodes} [otherNodeName.Key] = otherNodeName.Value;
97             \}
98 
99             \textcolor{keywordflow}{foreach} (var otherString \textcolor{keywordflow}{in} otherProgram.strings) \{
100 
101                 \textcolor{keywordflow}{if} (\hyperlink{a00067_a3f4928a577c88263ad016be259b175c4}{nodes}.ContainsKey(otherString.Key)) \{
102                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} InvalidOperationException (\textcolor{keywordtype}{string}.Format (\textcolor{stringliteral}{"This program already contains a
       string with key \{0\}"}, otherString.Key));
103                 \}
104 
105                 \hyperlink{a00067_a91518fda7e41bf573f66c6946dd3b4cb}{strings} [otherString.Key] = otherString.Value;
106             \}
107         \}
\end{DoxyCode}
\hypertarget{a00067_a13c9b747b37e404e2d0713468b2a78ff}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!Register\-String@{Register\-String}}
\index{Register\-String@{Register\-String}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{Register\-String}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Program.\-Register\-String (
\begin{DoxyParamCaption}
\item[{string}]{the\-String, }
\item[{string}]{for\-Node}
\end{DoxyParamCaption}
)}}\label{a00067_a13c9b747b37e404e2d0713468b2a78ff}

\begin{DoxyCode}
16                                                                        \{
17 
18             var key = string.Format (\textcolor{stringliteral}{"\{0\}-\{1\}"}, forNode, \hyperlink{a00067_a8ef1d10094ef00311aade6715ba78ec7}{stringCount}++);
19 
20             \textcolor{comment}{// It's not in the list; append it}
21             strings.Add(key, theString);
22 
23             \textcolor{keywordflow}{return} key;
24         \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{a00067_a3f4928a577c88263ad016be259b175c4}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!nodes@{nodes}}
\index{nodes@{nodes}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{nodes}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string, {\bf Node}$>$ Yarn.\-Program.\-nodes = new Dictionary$<$string, {\bf Node}$>$ ()}}\label{a00067_a3f4928a577c88263ad016be259b175c4}
\hypertarget{a00067_a8ef1d10094ef00311aade6715ba78ec7}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!string\-Count@{string\-Count}}
\index{string\-Count@{string\-Count}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{string\-Count}]{\setlength{\rightskip}{0pt plus 5cm}int Yarn.\-Program.\-string\-Count = 0\hspace{0.3cm}{\ttfamily [private]}}}\label{a00067_a8ef1d10094ef00311aade6715ba78ec7}
\hypertarget{a00067_a91518fda7e41bf573f66c6946dd3b4cb}{\index{Yarn\-::\-Program@{Yarn\-::\-Program}!strings@{strings}}
\index{strings@{strings}!Yarn::Program@{Yarn\-::\-Program}}
\subsubsection[{strings}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string,string$>$ Yarn.\-Program.\-strings = new Dictionary$<$string, string$>$ ()}}\label{a00067_a91518fda7e41bf573f66c6946dd3b4cb}


The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
Yarn\-Spinner/\hyperlink{a00116}{Compiler.\-cs}\end{DoxyCompactItemize}
