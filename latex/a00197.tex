\hypertarget{a00197}{\section{Yarn.\-Yarn\-Spinner\-Console Class Reference}
\label{a00197}\index{Yarn.\-Yarn\-Spinner\-Console@{Yarn.\-Yarn\-Spinner\-Console}}
}


Collaboration diagram for Yarn.\-Yarn\-Spinner\-Console\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{a00759}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{a00058}{Console\-Runner\-Implementation}
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{a00197_a2f63f9f5b7634cb50ee75ff2eb18b137}{Error} (params string\mbox{[}$\,$\mbox{]} messages)
\item 
static void \hyperlink{a00197_a939cc9e943c574b36c6af93e9c772702}{Note} (params string\mbox{[}$\,$\mbox{]} messages)
\item 
static void \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn} (params string\mbox{[}$\,$\mbox{]} messages)
\item 
static void \hyperlink{a00197_a1d71ff2eb190449ea1d42ce86f44489f}{Main} (string\mbox{[}$\,$\mbox{]} args)
\end{DoxyCompactItemize}
\subsection*{Static Package Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{a00094}{Dialogue} \hyperlink{a00197_aff69d6e16dddb077f87a616a57cd3c66}{Create\-Dialogue\-For\-Utilities} ()
\item 
static void \hyperlink{a00197_ad77564b25725a771f0fd4da430582e6f}{Check\-File\-List} (I\-List$<$ string $>$ paths, List$<$ string $>$ allowed\-Extensions)
\item 
static \hyperlink{a00094}{Dialogue} \hyperlink{a00197_aab244361a510cee18ad2f636d110e0d5}{Create\-Dialogue} (\hyperlink{a00105}{Execution\-Options} options, \hyperlink{a00058}{Console\-Runner\-Implementation} impl)
\end{DoxyCompactItemize}
\subsection*{Static Package Attributes}
\begin{DoxyCompactItemize}
\item 
static List$<$ string $>$ \hyperlink{a00197_a0979de7ea02c8c0375b8220a12e6575e}{A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S} = new List$<$string$>$(new string\mbox{[}$\,$\mbox{]} \{ \char`\"{}.json\char`\"{}, \char`\"{}.node\char`\"{}, \char`\"{}.yarn.\-bytes\char`\"{}, \char`\"{}.yarn.\-txt\char`\"{} \})
\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static int \hyperlink{a00197_a1b974c55540795a9e643c2ec055fbd51}{Run} (\hyperlink{a00159}{Run\-Options} options)
\item 
static int \hyperlink{a00197_a029a5624e7cc3a16ae586b64f13049de}{Verify} (\hyperlink{a00194}{Verify\-Options} options)
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 142 of file Main.\-cs.



\subsection{Member Function Documentation}
\hypertarget{a00197_ad77564b25725a771f0fd4da430582e6f}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Check\-File\-List@{Check\-File\-List}}
\index{Check\-File\-List@{Check\-File\-List}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Check\-File\-List}]{\setlength{\rightskip}{0pt plus 5cm}static void Yarn.\-Yarn\-Spinner\-Console.\-Check\-File\-List (
\begin{DoxyParamCaption}
\item[{I\-List$<$ string $>$}]{paths, }
\item[{List$<$ string $>$}]{allowed\-Extensions}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [package]}}}\label{a00197_ad77564b25725a771f0fd4da430582e6f}


Definition at line 206 of file Main.\-cs.



References Yarn.\-Yarn\-Spinner\-Console.\-Error(), and Yarn.\-Yarn\-Spinner\-Console.\-Warn().



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Run(), and Yarn.\-Yarn\-Spinner\-Console.\-Verify().


\begin{DoxyCode}
207         \{
208 
209             \textcolor{keywordflow}{if} (paths.Count == 0)
210             \{
211                 \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn}(\textcolor{stringliteral}{"No files provided."});
212                 \textcolor{keywordflow}{return};
213             \}
214 
215             var invalid = \textcolor{keyword}{new} List<string>();
216 
217             \textcolor{keywordflow}{foreach} (var path \textcolor{keywordflow}{in} paths)
218             \{
219                 \textcolor{comment}{// Does this file exist?}
220                 var exists = System.IO.File.Exists(path);
221 
222                 \textcolor{comment}{// Does this file have the right extension?}
223 
224                 var hasAllowedExtension = allowedExtensions.FindIndex(item => path.EndsWith(item, 
      StringComparison.InvariantCulture)) != -1;
225 
226                 \textcolor{keywordflow}{if} (!exists || !hasAllowedExtension)
227                 \{
228                     invalid.Add(string.Format(CultureInfo.CurrentCulture, \textcolor{stringliteral}{"\(\backslash\)"\{0\}\(\backslash\)""}, path));
229                 \}
230             \}
231 
232             \textcolor{keywordflow}{if} (invalid.Count != 0)
233             \{
234 
235                 var message = string.Format(CultureInfo.CurrentCulture, \textcolor{stringliteral}{"The file\{0\} \{1\} \{2\}."},
236                     invalid.Count == 1 ? \textcolor{stringliteral}{""} : \textcolor{stringliteral}{"s"},
237                                             string.Join(\textcolor{stringliteral}{", "}, invalid.ToArray()),
238                     invalid.Count == 1 ? \textcolor{stringliteral}{"is not valid"} : \textcolor{stringliteral}{"are not valid"}
239                 );
240 
241                 \hyperlink{a00197_a2f63f9f5b7634cb50ee75ff2eb18b137}{Error}(message);
242             \}
243         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_ad77564b25725a771f0fd4da430582e6f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_ad77564b25725a771f0fd4da430582e6f_icgraph}
\end{center}
\end{figure}


\hypertarget{a00197_aab244361a510cee18ad2f636d110e0d5}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Create\-Dialogue@{Create\-Dialogue}}
\index{Create\-Dialogue@{Create\-Dialogue}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Create\-Dialogue}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Dialogue} Yarn.\-Yarn\-Spinner\-Console.\-Create\-Dialogue (
\begin{DoxyParamCaption}
\item[{{\bf Execution\-Options}}]{options, }
\item[{{\bf Console\-Runner\-Implementation}}]{impl}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [package]}}}\label{a00197_aab244361a510cee18ad2f636d110e0d5}


Definition at line 388 of file Main.\-cs.



References Yarn.\-Value.\-As\-Bool, Yarn.\-Yarn\-Spinner\-Console.\-Error(), Yarn.\-Execution\-Options.\-experimental, Yarn.\-Yarn\-Spinner\-Console.\-Note(), Yarn.\-Base\-Options.\-show\-Debugging\-Info, and Yarn.\-Yarn\-Spinner\-Console.\-Warn().



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Run(), and Yarn.\-Yarn\-Spinner\-Console.\-Verify().


\begin{DoxyCode}
389         \{
390 
391             \textcolor{comment}{// Load nodes}
392             var dialogue = \textcolor{keyword}{new} Dialogue(impl);
393 
394             \textcolor{keywordflow}{if} (options.experimental)
395             \{
396                 \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn}(\textcolor{stringliteral}{"Running YarnSpinner in experimental mode may have unexpected behaviour."});
397                 dialogue.experimentalMode = \textcolor{keyword}{true};
398             \}
399 
400             \textcolor{comment}{// Add some methods for testing}
401             dialogue.library.RegisterFunction(\textcolor{stringliteral}{"add\_three\_operands"}, 3, delegate (Value[] parameters)
402             \{
403                 \textcolor{keywordflow}{return} parameters[0] + parameters[1] + parameters[2];
404             \});
405 
406             dialogue.library.RegisterFunction(\textcolor{stringliteral}{"last\_value"}, -1, delegate (Value[] parameters)
407             \{
408                 \textcolor{comment}{// return the last value}
409                 \textcolor{keywordflow}{return} parameters[parameters.Length - 1];
410             \});
411 
412             dialogue.library.RegisterFunction(\textcolor{stringliteral}{"is\_even"}, 1, delegate (Value[] parameters)
413             \{
414                 \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})parameters[0].AsNumber % 2 == 0;
415             \});
416 
417             \textcolor{comment}{// Register the "assert" function, which stops execution if its parameter evaluates to false}
418             dialogue.library.RegisterFunction(\textcolor{stringliteral}{"assert"}, -1, delegate (Value[] parameters)
419             \{
420                 \textcolor{keywordflow}{if} (parameters[0].AsBool == \textcolor{keyword}{false})
421                 \{
422 
423                     \textcolor{comment}{// TODO: Include file, node and line number}
424                     \textcolor{keywordflow}{if} (parameters.Length > 1 && parameters[1].AsBool)
425                     \{
426                         dialogue.LogErrorMessage(\textcolor{stringliteral}{"ASSERTION FAILED: "} + parameters[1].AsString);
427                     \}
428                     \textcolor{keywordflow}{else}
429                     \{
430                         dialogue.LogErrorMessage(\textcolor{stringliteral}{"ASSERTION FAILED"});
431                     \}
432                     Environment.Exit(1);
433                 \}
434             \});
435 
436 
437             \textcolor{comment}{// Register a function to let test scripts register how many}
438             \textcolor{comment}{// options they expect to send}
439             dialogue.library.RegisterFunction(\textcolor{stringliteral}{"prepare\_for\_options"}, 2, delegate (Value[] parameters)
440             \{
441                 impl.numberOfExpectedOptions = (int)parameters[0].AsNumber;
442                 impl.autoSelectOptionNumber = (int)parameters[1].AsNumber;
443             \});
444 
445             dialogue.library.RegisterFunction(\textcolor{stringliteral}{"expect\_line"}, 1, delegate (Value[] parameters)
446             \{
447                 impl.expectedNextLine = parameters[0].AsString;
448             \});
449 
450             dialogue.library.RegisterFunction(\textcolor{stringliteral}{"expect\_command"}, 1, delegate (Value[] parameters)
451             \{
452                 impl.expectedNextCommand = parameters[0].AsString;
453             \});
454 
455             \textcolor{comment}{// If debugging is enabled, log debug messages; otherwise, ignore them}
456             \textcolor{keywordflow}{if} (options.showDebuggingInfo)
457             \{
458                 dialogue.LogDebugMessage = delegate (\textcolor{keywordtype}{string} message)
459                 \{
460                     \hyperlink{a00197_a939cc9e943c574b36c6af93e9c772702}{Note}(message);
461                 \};
462             \}
463             \textcolor{keywordflow}{else}
464             \{
465                 dialogue.LogDebugMessage = delegate (\textcolor{keywordtype}{string} message) \{ \};
466             \}
467 
468             dialogue.LogErrorMessage = delegate (\textcolor{keywordtype}{string} message)
469             \{
470                 \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn}(\textcolor{stringliteral}{"Yarn Error: "} + message);
471             \};
472 
473             \textcolor{keywordflow}{foreach} (var file \textcolor{keywordflow}{in} options.files)
474             \{
475                 \textcolor{keywordflow}{try}
476                 \{
477                     dialogue.LoadFile(file, \textcolor{keyword}{false}, \textcolor{keyword}{false}, options.onlyConsiderNode);
478                 \}
479                 \textcolor{keywordflow}{catch} (Yarn.TokeniserException e)
480                 \{
481                     \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn}(e.Message);
482                 \}
483                 \textcolor{keywordflow}{catch} (Yarn.ParseException e)
484                 \{
485                     \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn}(e.Message);
486                 \}
487 
488             \}
489 
490             \textcolor{comment}{// Load string table}
491             \textcolor{keywordflow}{if} (options.stringTable != null)
492             \{
493 
494                 var parsedTable = \textcolor{keyword}{new} Dictionary<string, string>();
495 
496                 \textcolor{keyword}{using} (var reader = \textcolor{keyword}{new} System.IO.StreamReader(options.stringTable))
497                 \{
498                     \textcolor{keyword}{using} (var csvReader = \textcolor{keyword}{new} \hyperlink{a00079}{CsvReader}(reader))
499                     \{
500                         \textcolor{keywordflow}{if} (csvReader.ReadHeader() == \textcolor{keyword}{false})
501                         \{
502                             \hyperlink{a00197_a2f63f9f5b7634cb50ee75ff2eb18b137}{Error}(\textcolor{keywordtype}{string}.Format(CultureInfo.CurrentCulture, \textcolor{stringliteral}{"\{0\} is not a valid string
       table"}, options.stringTable));
503                         \}
504 
505                         \textcolor{keywordflow}{foreach} (var row \textcolor{keywordflow}{in} csvReader.GetRecords<LocalisedLine>())
506                         \{
507                             parsedTable[row.LineCode] = row.LineText;
508                         \}
509                     \}
510                 \}
511 
512                 dialogue.AddStringTable(parsedTable);
513             \}
514 
515             \textcolor{keywordflow}{return} dialogue;
516         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_aab244361a510cee18ad2f636d110e0d5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_aab244361a510cee18ad2f636d110e0d5_icgraph}
\end{center}
\end{figure}


\hypertarget{a00197_aff69d6e16dddb077f87a616a57cd3c66}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Create\-Dialogue\-For\-Utilities@{Create\-Dialogue\-For\-Utilities}}
\index{Create\-Dialogue\-For\-Utilities@{Create\-Dialogue\-For\-Utilities}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Create\-Dialogue\-For\-Utilities}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Dialogue} Yarn.\-Yarn\-Spinner\-Console.\-Create\-Dialogue\-For\-Utilities (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [package]}}}\label{a00197_aff69d6e16dddb077f87a616a57cd3c66}


Definition at line 145 of file Main.\-cs.


\begin{DoxyCode}
146         \{
147 
148             \textcolor{comment}{// Note that we're passing in with a null library - this means}
149             \textcolor{comment}{// that all function checking will be disabled, and missing funcs}
150             \textcolor{comment}{// will not cause a compile error. If a func IS missing at runtime,}
151             \textcolor{comment}{// THAT will throw an exception.}
152 
153             \textcolor{comment}{// We do this because this tool has no idea about any of the custom}
154             \textcolor{comment}{// functions that you might be using.}
155 
156             Dialogue d = \textcolor{keyword}{new} Dialogue(null);
157 
158             \textcolor{comment}{// Debug logging goes to Note}
159             d.LogDebugMessage = message => YarnSpinnerConsole.Note(message);
160 
161             \textcolor{comment}{// When erroring, call Warn, not Error, which terminates the program}
162             d.LogErrorMessage = message => YarnSpinnerConsole.Warn(message);
163 
164             \textcolor{keywordflow}{return} d;
165         \}
\end{DoxyCode}
\hypertarget{a00197_a2f63f9f5b7634cb50ee75ff2eb18b137}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Error@{Error}}
\index{Error@{Error}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Error}]{\setlength{\rightskip}{0pt plus 5cm}static void Yarn.\-Yarn\-Spinner\-Console.\-Error (
\begin{DoxyParamCaption}
\item[{params string\mbox{[}$\,$\mbox{]}}]{messages}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{a00197_a2f63f9f5b7634cb50ee75ff2eb18b137}


Definition at line 167 of file Main.\-cs.



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Check\-File\-List(), Yarn.\-Yarn\-Spinner\-Console.\-Create\-Dialogue(), Yarn.\-Yarn\-Spinner\-Console.\-Console\-Runner\-Implementation.\-Handle\-Error\-Message(), Yarn.\-Yarn\-Spinner\-Console.\-Console\-Runner\-Implementation.\-Run\-Command(), Yarn.\-Yarn\-Spinner\-Console.\-Console\-Runner\-Implementation.\-Run\-Line(), Yarn.\-Yarn\-Spinner\-Console.\-Console\-Runner\-Implementation.\-Run\-Options(), and Yarn.\-Yarn\-Spinner\-Console.\-Verify().


\begin{DoxyCode}
168         \{
169 
170             \textcolor{keywordflow}{foreach} (var message \textcolor{keywordflow}{in} messages)
171             \{
172                 Console.ForegroundColor = ConsoleColor.DarkRed;
173                 Console.Write(\textcolor{stringliteral}{"Error: "});
174                 Console.ResetColor();
175                 Console.WriteLine(message);
176             \}
177 
178             Environment.Exit(1);
179         \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a2f63f9f5b7634cb50ee75ff2eb18b137_icgraph}
\end{center}
\end{figure}


\hypertarget{a00197_a1d71ff2eb190449ea1d42ce86f44489f}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Main@{Main}}
\index{Main@{Main}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Main}]{\setlength{\rightskip}{0pt plus 5cm}static void Yarn.\-Yarn\-Spinner\-Console.\-Main (
\begin{DoxyParamCaption}
\item[{string\mbox{[}$\,$\mbox{]}}]{args}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{a00197_a1d71ff2eb190449ea1d42ce86f44489f}


Definition at line 244 of file Main.\-cs.



References Yarn.\-Line\-Adder.\-Add\-Lines(), Yarn.\-File\-Format\-Converter.\-Convert\-Format(), Yarn.\-Program\-Exporter.\-Export(), Yarn.\-Table\-Generator.\-Generate\-Tables(), Yarn.\-Yarn\-Spinner\-Console.\-Run(), and Yarn.\-Yarn\-Spinner\-Console.\-Verify().


\begin{DoxyCode}
245         \{
246 
247             \textcolor{comment}{// Read and dispatch the appropriate command}
248             var results = CommandLine.Parser.Default.ParseArguments
249             <
250             RunOptions,
251             VerifyOptions,
252             CompileOptions,
253             GenerateTableOptions,
254             AddLabelsOptions,
255             ConvertFormatOptions
256             >(args);
257 
258             var returnCode = results.MapResult(
259                 (RunOptions options) => \hyperlink{a00197_a1b974c55540795a9e643c2ec055fbd51}{Run}(options),
260                 (VerifyOptions options) => \hyperlink{a00197_a029a5624e7cc3a16ae586b64f13049de}{Verify}(options),
261                 (CompileOptions options) => ProgramExporter.Export(options),
262                 (AddLabelsOptions options) => LineAdder.AddLines(options),
263                 (GenerateTableOptions options) => TableGenerator.GenerateTables(options),
264                 (ConvertFormatOptions options) => FileFormatConverter.ConvertFormat(options),
265 
266                 errors => \{ \textcolor{keywordflow}{return} 1; \});
267 
268             Environment.Exit(returnCode);
269 
270 
271         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a1d71ff2eb190449ea1d42ce86f44489f_cgraph}
\end{center}
\end{figure}


\hypertarget{a00197_a939cc9e943c574b36c6af93e9c772702}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Note@{Note}}
\index{Note@{Note}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Note}]{\setlength{\rightskip}{0pt plus 5cm}static void Yarn.\-Yarn\-Spinner\-Console.\-Note (
\begin{DoxyParamCaption}
\item[{params string\mbox{[}$\,$\mbox{]}}]{messages}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{a00197_a939cc9e943c574b36c6af93e9c772702}


Definition at line 181 of file Main.\-cs.



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Create\-Dialogue(), Yarn.\-Yarn\-Spinner\-Console.\-Console\-Runner\-Implementation.\-Handle\-Debug\-Message(), Yarn.\-Yarn\-Spinner\-Console.\-Console\-Runner\-Implementation.\-Run\-Options(), and Yarn.\-Yarn\-Spinner\-Console.\-Verify().


\begin{DoxyCode}
182         \{
183 
184             \textcolor{keywordflow}{foreach} (var message \textcolor{keywordflow}{in} messages)
185             \{
186                 Console.ForegroundColor = ConsoleColor.DarkBlue;
187                 Console.Write(\textcolor{stringliteral}{"Note: "});
188                 Console.ResetColor();
189                 Console.WriteLine(message);
190             \}
191 
192 
193         \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a939cc9e943c574b36c6af93e9c772702_icgraph}
\end{center}
\end{figure}


\hypertarget{a00197_a1b974c55540795a9e643c2ec055fbd51}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Run@{Run}}
\index{Run@{Run}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Run}]{\setlength{\rightskip}{0pt plus 5cm}static int Yarn.\-Yarn\-Spinner\-Console.\-Run (
\begin{DoxyParamCaption}
\item[{{\bf Run\-Options}}]{options}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}}\label{a00197_a1b974c55540795a9e643c2ec055fbd51}


Definition at line 275 of file Main.\-cs.



References Yarn.\-Yarn\-Spinner\-Console.\-A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S, Yarn.\-Yarn\-Spinner\-Console.\-Check\-File\-List(), Yarn.\-Yarn\-Spinner\-Console.\-Create\-Dialogue(), Yarn.\-Base\-Options.\-files, Yarn.\-Dialogue.\-Run(), Yarn.\-Run\-Options.\-wait\-For\-Input, and Yarn.\-Yarn\-Spinner\-Console.\-Warn().



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Main().


\begin{DoxyCode}
276         \{
277 
278             \hyperlink{a00197_ad77564b25725a771f0fd4da430582e6f}{CheckFileList}(options.files, \hyperlink{a00197_a0979de7ea02c8c0375b8220a12e6575e}{ALLOWED\_EXTENSIONS});
279 
280             \textcolor{comment}{// Create the object that handles callbacks}
281             var impl = \textcolor{keyword}{new} ConsoleRunnerImplementation(waitForLines: options.waitForInput);
282 
283             \textcolor{comment}{// load the default variables we got on the command line}
284             \textcolor{keywordflow}{foreach} (var variable \textcolor{keywordflow}{in} options.variables)
285             \{
286                 var entry = variable.Split(\textcolor{keyword}{new} \textcolor{keywordtype}{char}[] \{ \textcolor{charliteral}{'='} \}, StringSplitOptions.RemoveEmptyEntries);
287 
288                 \textcolor{keywordtype}{float} value;
289                 \textcolor{comment}{// If there aren't two parts to this or the second part isn't a float, fail}
290                 \textcolor{keywordflow}{if} (entry.Length != 2 || \textcolor{keywordtype}{float}.TryParse(entry[1], out value) == \textcolor{keyword}{false})
291                 \{
292                     \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn}(\textcolor{keywordtype}{string}.Format(CultureInfo.CurrentCulture, \textcolor{stringliteral}{"Skipping invalid variable \{0\}"}, 
      variable));
293                     \textcolor{keywordflow}{continue};
294                 \}
295                 var name = entry[0];
296 
297                 impl.SetNumber(name, value);
298             \}
299 
300             \textcolor{keywordflow}{if} (options.automaticallySelectFirstOption == \textcolor{keyword}{true})
301             \{
302                 impl.autoSelectFirstOption = \textcolor{keyword}{true};
303             \}
304 
305             Dialogue dialogue = \hyperlink{a00197_aab244361a510cee18ad2f636d110e0d5}{CreateDialogue}(options, impl);
306 
307             \textcolor{comment}{// Run the conversation}
308 
309             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} run = 0; run < options.runTimes; run++)
310             \{
311                 \textcolor{keywordflow}{foreach} (var step \textcolor{keywordflow}{in} dialogue.Run(options.startNode))
312                 \{
313 
314                     \textcolor{comment}{// It can be one of three types: a line to show, options}
315                     \textcolor{comment}{// to present to the user, or an internal command to run}
316 
317                     \textcolor{keywordflow}{if} (step is Dialogue.LineResult)
318                     \{
319                         var lineResult = step as Dialogue.LineResult;
320                         impl.RunLine(lineResult.line);
321                     \}
322                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (step is Dialogue.OptionSetResult)
323                     \{
324                         var optionsResult = step as Dialogue.OptionSetResult;
325                         impl.RunOptions(optionsResult.options, optionsResult.setSelectedOptionDelegate);
326                     \}
327                     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (step is Dialogue.CommandResult)
328                     \{
329                         var commandResult = step as Dialogue.CommandResult;
330                         impl.RunCommand(commandResult.command.text);
331                     \}
332                 \}
333                 impl.DialogueComplete();
334             \}
335             \textcolor{keywordflow}{return} 0;
336         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a1b974c55540795a9e643c2ec055fbd51_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a1b974c55540795a9e643c2ec055fbd51_icgraph}
\end{center}
\end{figure}


\hypertarget{a00197_a029a5624e7cc3a16ae586b64f13049de}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Verify@{Verify}}
\index{Verify@{Verify}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Verify}]{\setlength{\rightskip}{0pt plus 5cm}static int Yarn.\-Yarn\-Spinner\-Console.\-Verify (
\begin{DoxyParamCaption}
\item[{{\bf Verify\-Options}}]{options}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}}\label{a00197_a029a5624e7cc3a16ae586b64f13049de}


Definition at line 338 of file Main.\-cs.



References Yarn.\-Yarn\-Spinner\-Console.\-A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S, Yarn.\-Yarn\-Spinner\-Console.\-Check\-File\-List(), Yarn.\-Verify\-Options.\-compile\-And\-Exit, Yarn.\-Yarn\-Spinner\-Console.\-Create\-Dialogue(), Yarn.\-Yarn\-Spinner\-Console.\-Error(), Yarn.\-Base\-Options.\-files, Yarn.\-Yarn\-Spinner\-Console.\-Note(), and Yarn.\-Yarn\-Spinner\-Console.\-Warn().



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Main().


\begin{DoxyCode}
339         \{
340 
341             \hyperlink{a00197_ad77564b25725a771f0fd4da430582e6f}{CheckFileList}(options.files, \hyperlink{a00197_a0979de7ea02c8c0375b8220a12e6575e}{ALLOWED\_EXTENSIONS});
342 
343             Dialogue dialogue;
344             \textcolor{keywordflow}{try}
345             \{
346                 dialogue = \hyperlink{a00197_aab244361a510cee18ad2f636d110e0d5}{CreateDialogue}(options, null);
347             \}
348 \textcolor{preprocessor}{#pragma warning disable CA1031 // Do not catch general exception types}
349 \textcolor{preprocessor}{}            \textcolor{keywordflow}{catch}
350             \{
351                 \textcolor{keywordflow}{return} 1;
352             \}
353 \textcolor{preprocessor}{#pragma warning restore CA1031 // Do not catch general exception types}
354 \textcolor{preprocessor}{}
355             \textcolor{keywordflow}{if} (options.compileAndExit)
356             \{
357                 var result = dialogue.GetByteCode();
358                 Console.WriteLine(result);
359                 \textcolor{keywordflow}{return} 0;
360             \}
361 
362             var context = \textcolor{keyword}{new} \hyperlink{a00059}{Yarn.Analysis.Context}();
363 
364             dialogue.Analyse(context);
365 
366             \textcolor{keywordflow}{foreach} (var diagnosis \textcolor{keywordflow}{in} context.FinishAnalysis())
367             \{
368                 \textcolor{keywordflow}{switch} (diagnosis.severity)
369                 \{
370                     \textcolor{keywordflow}{case} Analysis.Diagnosis.Severity.Error:
371                         \hyperlink{a00197_a2f63f9f5b7634cb50ee75ff2eb18b137}{Error}(diagnosis.ToString(showSeverity: \textcolor{keyword}{false}));
372                         \textcolor{keywordflow}{break};
373                     \textcolor{keywordflow}{case} Analysis.Diagnosis.Severity.Warning:
374                         \hyperlink{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{Warn}(diagnosis.ToString(showSeverity: \textcolor{keyword}{false}));
375                         \textcolor{keywordflow}{break};
376                     \textcolor{keywordflow}{case} Analysis.Diagnosis.Severity.Note:
377                         \hyperlink{a00197_a939cc9e943c574b36c6af93e9c772702}{Note}(diagnosis.ToString(showSeverity: \textcolor{keyword}{false}));
378                         \textcolor{keywordflow}{break};
379                     \textcolor{keywordflow}{default}:
380                         \textcolor{keywordflow}{throw} \textcolor{keyword}{new} ArgumentOutOfRangeException();
381                 \}
382 
383             \}
384             \textcolor{keywordflow}{return} 0;
385 
386         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a029a5624e7cc3a16ae586b64f13049de_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a029a5624e7cc3a16ae586b64f13049de_icgraph}
\end{center}
\end{figure}


\hypertarget{a00197_a979bb6f049b6c5294f745a19e24ddd9d}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!Warn@{Warn}}
\index{Warn@{Warn}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{Warn}]{\setlength{\rightskip}{0pt plus 5cm}static void Yarn.\-Yarn\-Spinner\-Console.\-Warn (
\begin{DoxyParamCaption}
\item[{params string\mbox{[}$\,$\mbox{]}}]{messages}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{a00197_a979bb6f049b6c5294f745a19e24ddd9d}


Definition at line 195 of file Main.\-cs.



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Check\-File\-List(), Yarn.\-Yarn\-Spinner\-Console.\-Create\-Dialogue(), Yarn.\-Yarn\-Spinner\-Console.\-Run(), and Yarn.\-Yarn\-Spinner\-Console.\-Verify().


\begin{DoxyCode}
196         \{
197             \textcolor{keywordflow}{foreach} (var message \textcolor{keywordflow}{in} messages)
198             \{
199                 Console.ForegroundColor = ConsoleColor.DarkYellow;
200                 Console.Write(\textcolor{stringliteral}{"Warning: "});
201                 Console.ResetColor();
202                 Console.WriteLine(message);
203             \}
204         \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00197_a979bb6f049b6c5294f745a19e24ddd9d_icgraph}
\end{center}
\end{figure}




\subsection{Member Data Documentation}
\hypertarget{a00197_a0979de7ea02c8c0375b8220a12e6575e}{\index{Yarn\-::\-Yarn\-Spinner\-Console@{Yarn\-::\-Yarn\-Spinner\-Console}!A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S@{A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S}}
\index{A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S@{A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S}!Yarn::YarnSpinnerConsole@{Yarn\-::\-Yarn\-Spinner\-Console}}
\subsubsection[{A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S}]{\setlength{\rightskip}{0pt plus 5cm}List$<$string$>$ Yarn.\-Yarn\-Spinner\-Console.\-A\-L\-L\-O\-W\-E\-D\-\_\-\-E\-X\-T\-E\-N\-S\-I\-O\-N\-S = new List$<$string$>$(new string\mbox{[}$\,$\mbox{]} \{ \char`\"{}.json\char`\"{}, \char`\"{}.node\char`\"{}, \char`\"{}.yarn.\-bytes\char`\"{}, \char`\"{}.yarn.\-txt\char`\"{} \})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [package]}}}\label{a00197_a0979de7ea02c8c0375b8220a12e6575e}


Definition at line 273 of file Main.\-cs.



Referenced by Yarn.\-Line\-Adder.\-Add\-Lines(), Yarn.\-File\-Format\-Converter.\-Convert\-Format(), Yarn.\-Program\-Exporter.\-Export(), Yarn.\-Table\-Generator.\-Generate\-Tables(), Yarn.\-Yarn\-Spinner\-Console.\-Run(), and Yarn.\-Yarn\-Spinner\-Console.\-Verify().



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
Yarn\-Spinner\-Console/\hyperlink{a00328}{Main.\-cs}\end{DoxyCompactItemize}
