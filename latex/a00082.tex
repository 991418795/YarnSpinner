\hypertarget{a00082}{\section{Yarn.\-Dialogue Class Reference}
\label{a00082}\index{Yarn.\-Dialogue@{Yarn.\-Dialogue}}
}


The \hyperlink{a00082}{Dialogue} class is the main thing that clients will use.  




Collaboration diagram for Yarn.\-Dialogue\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00600}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{a00042}{Command\-Result}
\begin{DoxyCompactList}\small\item\em The client should run a command (it's up to them to parse the string) \end{DoxyCompactList}\item 
class \hyperlink{a00122}{Line\-Result}
\begin{DoxyCompactList}\small\item\em The client should run a line of dialogue. \end{DoxyCompactList}\item 
class \hyperlink{a00129}{Node\-Complete\-Result}
\begin{DoxyCompactList}\small\item\em We've reached the end of this node. \end{DoxyCompactList}\item 
class \hyperlink{a00135}{Option\-Set\-Result}
\begin{DoxyCompactList}\small\item\em The client should show a list of options, and call set\-Selected\-Option\-Delegate before asking for the next line. It's an error if you don't. \end{DoxyCompactList}\item 
class \hyperlink{a00146}{Runner\-Result}
\begin{DoxyCompactList}\small\item\em Represents something for the end user (\char`\"{}client\char`\"{}) of the \hyperlink{a00082}{Dialogue} class to do. \end{DoxyCompactList}\item 
class \hyperlink{a00154}{Standard\-Library}
\begin{DoxyCompactList}\small\item\em The standard, built-\/in library of functions and operators. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{a00082_a903f18cdcc66c28ceab5a43c41fe074d}{Compiled\-Format} \{ \hyperlink{a00082_a903f18cdcc66c28ceab5a43c41fe074dab4daca084ad9eabfc8de231929477ed6}{Compiled\-Format.\-V1}
 \}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{a00082_a349debf4c4b8d48e3d80ff31ad380b0e}{Dialogue} (\hyperlink{a00180}{Yarn.\-Variable\-Storage} \hyperlink{a00082_ae94eaa4b03b432422f5d205fabe37ff5}{continuity})
\item 
void \hyperlink{a00082_af868f7f6928d122ca1d1857be433d92b}{Load\-File} (string file\-Name, bool show\-Tokens=false, bool show\-Parse\-Tree=false, string only\-Consider\-Node=null)
\begin{DoxyCompactList}\small\item\em Load a file from disk. \end{DoxyCompactList}\item 
void \hyperlink{a00082_a4bc1ceca26754dc3ec0a2281dfee26ce}{Load\-Compiled\-Program} (byte\mbox{[}$\,$\mbox{]} bytes, string file\-Name, \hyperlink{a00082_a903f18cdcc66c28ceab5a43c41fe074d}{Compiled\-Format} format=\hyperlink{a00082_a3bc83587462ade6a2f7f42cb7576e50e}{L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T})
\item 
void \hyperlink{a00082_a7b66187877ec8a2bfee2298d3dd16706}{Load\-String} (string text, string file\-Name=\char`\"{}$<$input$>$\char`\"{}, bool show\-Tokens=false, bool show\-Parse\-Tree=false, string only\-Consider\-Node=null)
\begin{DoxyCompactList}\small\item\em Ask the loader to parse a string. \end{DoxyCompactList}\item 
I\-Enumerable\\*
$<$ \hyperlink{a00146}{Yarn.\-Dialogue.\-Runner\-Result} $>$ \hyperlink{a00082_aead84ee50cb113ca45724894290ce9c2}{Run} (string start\-Node=\hyperlink{a00082_a1b643f15f734090e6a58cbf13dafd28f}{D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T})
\begin{DoxyCompactList}\small\item\em Use this in a for-\/each construct; each time you iterate over it, you'll get a line, command, or set of options. \end{DoxyCompactList}\item 
void \hyperlink{a00082_a7a6cabe5612fdcdc4619460431f85112}{Stop} ()
\item 
Dictionary$<$ string, string $>$ \hyperlink{a00082_a7c83b1fe5474a6610d39eb525f6fc9ce}{Get\-Text\-For\-All\-Nodes} ()
\item 
string \hyperlink{a00082_a594641914a2b59cc5231645273d18e82}{Get\-Text\-For\-Node} (string node\-Name)
\begin{DoxyCompactList}\small\item\em Returns the source code for the node 'node\-Name', if that node was tagged with raw\-Text. \end{DoxyCompactList}\item 
void \hyperlink{a00082_acfb8561e08dc85c6d9a855ad07d18783}{Add\-String\-Table} (Dictionary$<$ string, string $>$ string\-Table)
\item 
Dictionary$<$ string, string $>$ \hyperlink{a00082_af5fe57ebd11c41208070972f06a31b9d}{Get\-String\-Table} ()
\item 
byte\mbox{[}$\,$\mbox{]} \hyperlink{a00082_a5b664d4bbe7c47c246fe0beca9648687}{Get\-Compiled\-Program} (\hyperlink{a00082_a903f18cdcc66c28ceab5a43c41fe074d}{Compiled\-Format} format=\hyperlink{a00082_a3bc83587462ade6a2f7f42cb7576e50e}{L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T})
\item 
void \hyperlink{a00082_a7acfe32f91b36ee812059f2ad3011133}{Unload\-All} (bool clear\-Visited\-Nodes=true)
\begin{DoxyCompactList}\small\item\em Unloads A\-L\-L nodes. \end{DoxyCompactList}\item 
\hyperlink{a00041_a301aa7c866593a5b625a8fc158bbeacea27118326006d3829667a400ad23d5d98}{String} \hyperlink{a00082_a7a8a3a461011172f5624da3a8ffa875f}{Compile} ()
\item 
\hyperlink{a00041_a301aa7c866593a5b625a8fc158bbeacea27118326006d3829667a400ad23d5d98}{String} \hyperlink{a00082_aade6c069db8f01572060d25a963d2a14}{Get\-Byte\-Code} ()
\item 
bool \hyperlink{a00082_a93bb76a1f9a4058f225ff4cee97483c6}{Node\-Exists} (string node\-Name)
\item 
void \hyperlink{a00082_a6b67b239f50c062160666e54592c433f}{Analyse} (\hyperlink{a00047}{Analysis.\-Context} context)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{a00082_a2a5ac23441861eef13c59044cc218f09}{experimental\-Mode} = false
\begin{DoxyCompactList}\small\item\em We'll ask this object for the state of variables. \end{DoxyCompactList}\item 
\hyperlink{a00041_a1e50031b945a3a2afafee6f590730568}{Logger} \hyperlink{a00082_a381f48bb0fbb294f8cf44ca57f11be31}{Log\-Debug\-Message}
\begin{DoxyCompactList}\small\item\em Delegates used for logging. \end{DoxyCompactList}\item 
\hyperlink{a00041_a1e50031b945a3a2afafee6f590730568}{Logger} \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{Log\-Error\-Message}
\item 
const string \hyperlink{a00082_a1b643f15f734090e6a58cbf13dafd28f}{D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T} = \char`\"{}Start\char`\"{}
\begin{DoxyCompactList}\small\item\em The node we start from. \end{DoxyCompactList}\item 
\hyperlink{a00119}{Library} \hyperlink{a00082_ae660d4cfb6e296358d2f61d8ee74c66a}{library}
\begin{DoxyCompactList}\small\item\em The library contains all of the functions and operators we know about. \end{DoxyCompactList}\item 
Dictionary$<$ \hyperlink{a00041_a301aa7c866593a5b625a8fc158bbeacea27118326006d3829667a400ad23d5d98}{String}, int $>$ \hyperlink{a00082_aae9e64354066a1e2fa130629959d772b}{visited\-Node\-Count} = new Dictionary$<$string, int$>$()
\begin{DoxyCompactList}\small\item\em The collection of nodes that we've seen. \end{DoxyCompactList}\item 
const \hyperlink{a00082_a903f18cdcc66c28ceab5a43c41fe074d}{Compiled\-Format} \hyperlink{a00082_a3bc83587462ade6a2f7f42cb7576e50e}{L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T} = Compiled\-Format.\-V1
\end{DoxyCompactItemize}
\subsection*{Package Functions}
\begin{DoxyCompactItemize}
\item 
Dictionary$<$ string, \hyperlink{a00121}{Line\-Info} $>$ \hyperlink{a00082_a5c5117de678626ebcfb9a6f875e6e53a}{Get\-String\-Info\-Table} ()
\end{DoxyCompactItemize}
\subsection*{Package Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{a00180}{Variable\-Storage} \hyperlink{a00082_ae94eaa4b03b432422f5d205fabe37ff5}{continuity}
\item 
\hyperlink{a00123}{Loader} \hyperlink{a00082_a98bbe0ac2ccadeeeb7e05e3e6e19f2e0}{loader}
\begin{DoxyCompactList}\small\item\em The loader contains all of the nodes we're going to run. \end{DoxyCompactList}\item 
\hyperlink{a00142}{Program} \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}
\begin{DoxyCompactList}\small\item\em The \hyperlink{a00142}{Program} is the compiled \hyperlink{a00041}{Yarn} program. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Properties}
\begin{DoxyCompactItemize}
\item 
I\-Enumerable$<$ string $>$ \hyperlink{a00082_ac5661051e0b7f44527fe526c7766dbbf}{visited\-Nodes}\hspace{0.3cm}{\ttfamily  \mbox{[}get, set\mbox{]}}
\item 
I\-Enumerable$<$ string $>$ \hyperlink{a00082_a0ee573e3d072bccf98ba1d975612d42c}{all\-Nodes}\hspace{0.3cm}{\ttfamily  \mbox{[}get\mbox{]}}
\item 
string \hyperlink{a00082_af368b5c342d585dc6953876c5965ccc8}{current\-Node}\hspace{0.3cm}{\ttfamily  \mbox{[}get\mbox{]}}
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
object \hyperlink{a00082_a10c9f22d3f55e74f091cd6069c431094}{Yarn\-Function\-Node\-Visit\-Count} (\hyperlink{a00177}{Value}\mbox{[}$\,$\mbox{]} parameters)
\begin{DoxyCompactList}\small\item\em A function exposed to \hyperlink{a00041}{Yarn} that returns the number of times a node has been run. \end{DoxyCompactList}\item 
object \hyperlink{a00082_a1ab129bd84381928531d503304ca08d6}{Yarn\-Function\-Is\-Node\-Visited} (\hyperlink{a00177}{Value}\mbox{[}$\,$\mbox{]} parameters)
\begin{DoxyCompactList}\small\item\em A \hyperlink{a00041}{Yarn} function that returns true if the named node, or the current node if no parameters were provided, has been visited at least once. \end{DoxyCompactList}\item 
void \hyperlink{a00082_a706df08e842c2419f7a66fd40c0a544f}{Load\-Compiled\-Program\-V1} (byte\mbox{[}$\,$\mbox{]} bytes)
\item 
byte\mbox{[}$\,$\mbox{]} \hyperlink{a00082_a070898dbc07fd7d0a74d7c3ac1848beb}{Get\-Compiled\-Program\-V1} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{a00152}{Virtual\-Machine} \hyperlink{a00082_a8c1319357a9df6cff051328fb33224c7}{vm}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The \hyperlink{a00082}{Dialogue} class is the main thing that clients will use. 

Definition at line 122 of file Dialogue.\-cs.



\subsection{Member Enumeration Documentation}
\hypertarget{a00082_a903f18cdcc66c28ceab5a43c41fe074d}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Compiled\-Format@{Compiled\-Format}}
\index{Compiled\-Format@{Compiled\-Format}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Compiled\-Format}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Yarn.\-Dialogue.\-Compiled\-Format}}}\label{a00082_a903f18cdcc66c28ceab5a43c41fe074d}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{V1@{V1}!Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}}\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!V1@{V1}}\item[{\em 
\hypertarget{a00082_a903f18cdcc66c28ceab5a43c41fe074dab4daca084ad9eabfc8de231929477ed6}{V1}\label{a00082_a903f18cdcc66c28ceab5a43c41fe074dab4daca084ad9eabfc8de231929477ed6}
}]\end{description}
\end{Desc}


Definition at line 516 of file Dialogue.\-cs.


\begin{DoxyCode}
517         \{
518             \hyperlink{a00082_a903f18cdcc66c28ceab5a43c41fe074dab4daca084ad9eabfc8de231929477ed6}{V1}
519         \}
\end{DoxyCode}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{a00082_a349debf4c4b8d48e3d80ff31ad380b0e}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Dialogue@{Dialogue}}
\index{Dialogue@{Dialogue}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Dialogue}]{\setlength{\rightskip}{0pt plus 5cm}Yarn.\-Dialogue.\-Dialogue (
\begin{DoxyParamCaption}
\item[{{\bf Yarn.\-Variable\-Storage}}]{continuity}
\end{DoxyParamCaption}
)}}\label{a00082_a349debf4c4b8d48e3d80ff31ad380b0e}


Definition at line 246 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-continuity, Yarn.\-Dialogue.\-library, Yarn.\-Dialogue.\-loader, Yarn.\-Returning\-Function(), Yarn.\-Dialogue.\-Yarn\-Function\-Is\-Node\-Visited(), and Yarn.\-Dialogue.\-Yarn\-Function\-Node\-Visit\-Count().


\begin{DoxyCode}
246                                                          \{
247             this.continuity = \hyperlink{a00082_ae94eaa4b03b432422f5d205fabe37ff5}{continuity};
248             \hyperlink{a00082_a98bbe0ac2ccadeeeb7e05e3e6e19f2e0}{loader} = \textcolor{keyword}{new} Loader (\textcolor{keyword}{this});
249             \hyperlink{a00082_ae660d4cfb6e296358d2f61d8ee74c66a}{library} = \textcolor{keyword}{new} Library ();
250 
251             library.ImportLibrary (\textcolor{keyword}{new} StandardLibrary ());
252 
253             \textcolor{comment}{// Register the "visited" function, which returns true if we've visited}
254             \textcolor{comment}{// a node previously (nodes are marked as visited when we leave them)}
255             library.RegisterFunction (\textcolor{stringliteral}{"visited"}, -1, (\hyperlink{a00041_a5177bf74fbfe7303fac9d8236c2e514b}{ReturningFunction})
      \hyperlink{a00082_a1ab129bd84381928531d503304ca08d6}{YarnFunctionIsNodeVisited});
256 
257             \textcolor{comment}{// Register the "visitCount" function, which returns the number of times}
258             \textcolor{comment}{// a node has been run (which increments when a node ends). If called with}
259             \textcolor{comment}{// no parameters, check the CURRENT node.}
260             library.RegisterFunction (\textcolor{stringliteral}{"visitCount"}, -1, (\hyperlink{a00041_a5177bf74fbfe7303fac9d8236c2e514b}{ReturningFunction})
      \hyperlink{a00082_a10c9f22d3f55e74f091cd6069c431094}{YarnFunctionNodeVisitCount});
261 
262         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a349debf4c4b8d48e3d80ff31ad380b0e_cgraph}
\end{center}
\end{figure}




\subsection{Member Function Documentation}
\hypertarget{a00082_acfb8561e08dc85c6d9a855ad07d18783}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Add\-String\-Table@{Add\-String\-Table}}
\index{Add\-String\-Table@{Add\-String\-Table}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Add\-String\-Table}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Add\-String\-Table (
\begin{DoxyParamCaption}
\item[{Dictionary$<$ string, string $>$}]{string\-Table}
\end{DoxyParamCaption}
)}}\label{a00082_acfb8561e08dc85c6d9a855ad07d18783}


Definition at line 503 of file Dialogue.\-cs.


\begin{DoxyCode}
504         \{
505             program.LoadStrings(stringTable);
506         \}
\end{DoxyCode}
\hypertarget{a00082_a6b67b239f50c062160666e54592c433f}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Analyse@{Analyse}}
\index{Analyse@{Analyse}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Analyse}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Analyse (
\begin{DoxyParamCaption}
\item[{{\bf Analysis.\-Context}}]{context}
\end{DoxyParamCaption}
)}}\label{a00082_a6b67b239f50c062160666e54592c433f}


Definition at line 591 of file Dialogue.\-cs.


\begin{DoxyCode}
591                                                       \{
592 
593             context.AddProgramToAnalysis (this.program);
594 
595         \}
\end{DoxyCode}
\hypertarget{a00082_a7a8a3a461011172f5624da3a8ffa875f}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Compile@{Compile}}
\index{Compile@{Compile}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Compile}]{\setlength{\rightskip}{0pt plus 5cm}{\bf String} Yarn.\-Dialogue.\-Compile (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{a00082_a7a8a3a461011172f5624da3a8ffa875f}


Definition at line 559 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-library.


\begin{DoxyCode}
559                                 \{
560             \textcolor{keywordflow}{return} program.DumpCode (\hyperlink{a00082_ae660d4cfb6e296358d2f61d8ee74c66a}{library});
561         \}
\end{DoxyCode}
\hypertarget{a00082_aade6c069db8f01572060d25a963d2a14}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Get\-Byte\-Code@{Get\-Byte\-Code}}
\index{Get\-Byte\-Code@{Get\-Byte\-Code}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Get\-Byte\-Code}]{\setlength{\rightskip}{0pt plus 5cm}{\bf String} Yarn.\-Dialogue.\-Get\-Byte\-Code (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{a00082_aade6c069db8f01572060d25a963d2a14}


Definition at line 563 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-library.


\begin{DoxyCode}
563                                     \{
564             \textcolor{keywordflow}{return} program.DumpCode (\hyperlink{a00082_ae660d4cfb6e296358d2f61d8ee74c66a}{library});
565         \}
\end{DoxyCode}
\hypertarget{a00082_a5b664d4bbe7c47c246fe0beca9648687}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Get\-Compiled\-Program@{Get\-Compiled\-Program}}
\index{Get\-Compiled\-Program@{Get\-Compiled\-Program}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Get\-Compiled\-Program}]{\setlength{\rightskip}{0pt plus 5cm}byte \mbox{[}$\,$\mbox{]} Yarn.\-Dialogue.\-Get\-Compiled\-Program (
\begin{DoxyParamCaption}
\item[{{\bf Compiled\-Format}}]{format = {\ttfamily {\bf L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T}}}
\end{DoxyParamCaption}
)}}\label{a00082_a5b664d4bbe7c47c246fe0beca9648687}


Definition at line 523 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Get\-Compiled\-Program\-V1().


\begin{DoxyCode}
524         \{
525 
526             \textcolor{keywordflow}{switch} (format)
527             \{
528                 \textcolor{keywordflow}{case} CompiledFormat.V1:
529                     \textcolor{keywordflow}{return} \hyperlink{a00082_a070898dbc07fd7d0a74d7c3ac1848beb}{GetCompiledProgramV1}();
530                 \textcolor{keywordflow}{default}:
531                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} ArgumentOutOfRangeException();
532             \}
533         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a5b664d4bbe7c47c246fe0beca9648687_cgraph}
\end{center}
\end{figure}


\hypertarget{a00082_a070898dbc07fd7d0a74d7c3ac1848beb}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Get\-Compiled\-Program\-V1@{Get\-Compiled\-Program\-V1}}
\index{Get\-Compiled\-Program\-V1@{Get\-Compiled\-Program\-V1}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Get\-Compiled\-Program\-V1}]{\setlength{\rightskip}{0pt plus 5cm}byte \mbox{[}$\,$\mbox{]} Yarn.\-Dialogue.\-Get\-Compiled\-Program\-V1 (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{a00082_a070898dbc07fd7d0a74d7c3ac1848beb}


Definition at line 535 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Get\-Compiled\-Program().


\begin{DoxyCode}
536         \{
537             \textcolor{keyword}{using} (var outputStream = \textcolor{keyword}{new} System.IO.MemoryStream())
538             \{
539                 \textcolor{keyword}{using} (var bsonWriter = \textcolor{keyword}{new} Newtonsoft.Json.Bson.BsonWriter(outputStream))
540                 \{
541                     var s = \textcolor{keyword}{new} Newtonsoft.Json.JsonSerializer();
542                     s.Serialize(bsonWriter, this.program);
543                 \}
544 
545                 \textcolor{keywordflow}{return} outputStream.ToArray();
546             \}
547         \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a070898dbc07fd7d0a74d7c3ac1848beb_icgraph}
\end{center}
\end{figure}


\hypertarget{a00082_a5c5117de678626ebcfb9a6f875e6e53a}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Get\-String\-Info\-Table@{Get\-String\-Info\-Table}}
\index{Get\-String\-Info\-Table@{Get\-String\-Info\-Table}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Get\-String\-Info\-Table}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string,{\bf Line\-Info}$>$ Yarn.\-Dialogue.\-Get\-String\-Info\-Table (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [package]}}}\label{a00082_a5c5117de678626ebcfb9a6f875e6e53a}


Definition at line 512 of file Dialogue.\-cs.


\begin{DoxyCode}
512                                                                   \{
513             \textcolor{keywordflow}{return} program.lineInfo;
514         \}
\end{DoxyCode}
\hypertarget{a00082_af5fe57ebd11c41208070972f06a31b9d}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Get\-String\-Table@{Get\-String\-Table}}
\index{Get\-String\-Table@{Get\-String\-Table}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Get\-String\-Table}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string,string$>$ Yarn.\-Dialogue.\-Get\-String\-Table (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{a00082_af5fe57ebd11c41208070972f06a31b9d}


Definition at line 508 of file Dialogue.\-cs.


\begin{DoxyCode}
508                                                           \{
509             \textcolor{keywordflow}{return} program.strings;
510         \}
\end{DoxyCode}
\hypertarget{a00082_a7c83b1fe5474a6610d39eb525f6fc9ce}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Get\-Text\-For\-All\-Nodes@{Get\-Text\-For\-All\-Nodes}}
\index{Get\-Text\-For\-All\-Nodes@{Get\-Text\-For\-All\-Nodes}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Get\-Text\-For\-All\-Nodes}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<$string, string$>$ Yarn.\-Dialogue.\-Get\-Text\-For\-All\-Nodes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{a00082_a7c83b1fe5474a6610d39eb525f6fc9ce}


Definition at line 475 of file Dialogue.\-cs.



References Yarn.\-Program.\-nodes, and Yarn.\-Dialogue.\-program.


\begin{DoxyCode}
475                                                                \{
476             var d = \textcolor{keyword}{new} Dictionary<string,string>();
477 
478             \textcolor{keywordflow}{foreach} (var node \textcolor{keywordflow}{in} \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}.\hyperlink{a00142_a3f4928a577c88263ad016be259b175c4}{nodes}) \{
479                 var text = program.GetTextForNode(node.Key);
480 
481                 \textcolor{keywordflow}{if} (text == null)
482                     \textcolor{keywordflow}{continue};
483 
484                 d [node.Key] = text;
485             \}
486 
487             \textcolor{keywordflow}{return} d;
488         \}
\end{DoxyCode}
\hypertarget{a00082_a594641914a2b59cc5231645273d18e82}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Get\-Text\-For\-Node@{Get\-Text\-For\-Node}}
\index{Get\-Text\-For\-Node@{Get\-Text\-For\-Node}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Get\-Text\-For\-Node}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Dialogue.\-Get\-Text\-For\-Node (
\begin{DoxyParamCaption}
\item[{string}]{node\-Name}
\end{DoxyParamCaption}
)}}\label{a00082_a594641914a2b59cc5231645273d18e82}


Returns the source code for the node 'node\-Name', if that node was tagged with raw\-Text. 



Definition at line 491 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Log\-Error\-Message, Yarn.\-Program.\-nodes, and Yarn.\-Dialogue.\-program.


\begin{DoxyCode}
491                                                       \{
492             \textcolor{keywordflow}{if} (\hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}.\hyperlink{a00142_a3f4928a577c88263ad016be259b175c4}{nodes}.Count == 0) \{
493                 \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} (\textcolor{stringliteral}{"No nodes are loaded!"});
494                 \textcolor{keywordflow}{return} null;
495             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}.\hyperlink{a00142_a3f4928a577c88263ad016be259b175c4}{nodes}.ContainsKey(nodeName)) \{
496                 \textcolor{keywordflow}{return} program.GetTextForNode (nodeName);
497             \} \textcolor{keywordflow}{else} \{
498                 \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} (\textcolor{stringliteral}{"No node named "} + nodeName);
499                 \textcolor{keywordflow}{return} null;
500             \}
501         \}
\end{DoxyCode}
\hypertarget{a00082_a4bc1ceca26754dc3ec0a2281dfee26ce}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Load\-Compiled\-Program@{Load\-Compiled\-Program}}
\index{Load\-Compiled\-Program@{Load\-Compiled\-Program}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Load\-Compiled\-Program}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Load\-Compiled\-Program (
\begin{DoxyParamCaption}
\item[{byte\mbox{[}$\,$\mbox{]}}]{bytes, }
\item[{string}]{file\-Name, }
\item[{{\bf Compiled\-Format}}]{format = {\ttfamily {\bf L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T}}}
\end{DoxyParamCaption}
)}}\label{a00082_a4bc1ceca26754dc3ec0a2281dfee26ce}


Definition at line 287 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Load\-Compiled\-Program\-V1(), Yarn.\-Dialogue.\-Log\-Debug\-Message, and Yarn.\-Dialogue.\-Log\-Error\-Message.



Referenced by Yarn.\-Dialogue.\-Load\-File().


\begin{DoxyCode}
288         \{
289 
290             \textcolor{keywordflow}{if} (\hyperlink{a00082_a381f48bb0fbb294f8cf44ca57f11be31}{LogDebugMessage} == null)
291             \{
292                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} YarnException(\textcolor{stringliteral}{"LogDebugMessage must be set before loading"});
293             \}
294 
295             \textcolor{keywordflow}{if} (\hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} == null)
296             \{
297                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} YarnException(\textcolor{stringliteral}{"LogErrorMessage must be set before loading"});
298             \}
299 
300             \textcolor{keywordflow}{switch} (format)
301             \{
302                 \textcolor{keywordflow}{case} CompiledFormat.V1:
303                     \hyperlink{a00082_a706df08e842c2419f7a66fd40c0a544f}{LoadCompiledProgramV1}(bytes);
304                     \textcolor{keywordflow}{break};
305                 \textcolor{keywordflow}{default}:
306                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} ArgumentOutOfRangeException();
307             \}
308 
309         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a4bc1ceca26754dc3ec0a2281dfee26ce_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a4bc1ceca26754dc3ec0a2281dfee26ce_icgraph}
\end{center}
\end{figure}


\hypertarget{a00082_a706df08e842c2419f7a66fd40c0a544f}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Load\-Compiled\-Program\-V1@{Load\-Compiled\-Program\-V1}}
\index{Load\-Compiled\-Program\-V1@{Load\-Compiled\-Program\-V1}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Load\-Compiled\-Program\-V1}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Load\-Compiled\-Program\-V1 (
\begin{DoxyParamCaption}
\item[{byte\mbox{[}$\,$\mbox{]}}]{bytes}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{a00082_a706df08e842c2419f7a66fd40c0a544f}


Definition at line 311 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Log\-Error\-Message, and Yarn.\-Dialogue.\-program.



Referenced by Yarn.\-Dialogue.\-Load\-Compiled\-Program().


\begin{DoxyCode}
312         \{
313             \textcolor{keyword}{using} (var stream = \textcolor{keyword}{new} System.IO.MemoryStream(bytes))
314             \{
315                 \textcolor{keyword}{using} (var reader = \textcolor{keyword}{new} Newtonsoft.Json.Bson.BsonReader(stream))
316                 \{
317                     var serializer = \textcolor{keyword}{new} Newtonsoft.Json.JsonSerializer();
318 
319                     \textcolor{keywordflow}{try}
320                     \{
321                         \textcolor{comment}{// Load the stored program}
322                         var newProgram = serializer.Deserialize<Program>(reader);
323 
324                         \textcolor{comment}{// Merge it with our existing one, if present}
325                         \textcolor{keywordflow}{if} (\hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program} != null)
326                         \{
327                             program.Include(newProgram);
328                         \}
329                         \textcolor{keywordflow}{else} \{
330                             \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program} = newProgram;
331                         \}
332                     \}
333                     \textcolor{keywordflow}{catch} (Newtonsoft.Json.JsonReaderException e)
334                     \{
335                         \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage}(\textcolor{keywordtype}{string}.Format(\textcolor{stringliteral}{"Cannot load compiled program: \{0\}"}, e
      .Message));
336                     \}
337                 \}
338             \}
339         \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a706df08e842c2419f7a66fd40c0a544f_icgraph}
\end{center}
\end{figure}


\hypertarget{a00082_af868f7f6928d122ca1d1857be433d92b}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Load\-File@{Load\-File}}
\index{Load\-File@{Load\-File}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Load\-File}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Load\-File (
\begin{DoxyParamCaption}
\item[{string}]{file\-Name, }
\item[{bool}]{show\-Tokens = {\ttfamily false}, }
\item[{bool}]{show\-Parse\-Tree = {\ttfamily false}, }
\item[{string}]{only\-Consider\-Node = {\ttfamily null}}
\end{DoxyParamCaption}
)}}\label{a00082_af868f7f6928d122ca1d1857be433d92b}


Load a file from disk. 



Definition at line 265 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Load\-Compiled\-Program(), and Yarn.\-Dialogue.\-Load\-String().


\begin{DoxyCode}
265                                                                                                            
                            \{
266 
267             \textcolor{comment}{// Is this a compiled program file?}
268             \textcolor{keywordflow}{if} (fileName.EndsWith(\textcolor{stringliteral}{".yarn.bytes"})) \{
269 
270                 var bytes = System.IO.File.ReadAllBytes(fileName);
271                 \hyperlink{a00082_a4bc1ceca26754dc3ec0a2281dfee26ce}{LoadCompiledProgram}(bytes, fileName);
272 
273                 \textcolor{keywordflow}{return};
274             \} \textcolor{keywordflow}{else} \{
275                 \textcolor{comment}{// It's source code, either a single node in text form or a JSON file}
276                 \textcolor{keywordtype}{string} inputString;
277                 \textcolor{keyword}{using} (System.IO.StreamReader reader = \textcolor{keyword}{new} System.IO.StreamReader(fileName))
278                 \{
279                     inputString = reader.ReadToEnd();
280                 \}
281 
282                 \hyperlink{a00082_a7b66187877ec8a2bfee2298d3dd16706}{LoadString}(inputString, fileName, showTokens, showParseTree, onlyConsiderNode);
283             \}
284 
285         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_af868f7f6928d122ca1d1857be433d92b_cgraph}
\end{center}
\end{figure}


\hypertarget{a00082_a7b66187877ec8a2bfee2298d3dd16706}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Load\-String@{Load\-String}}
\index{Load\-String@{Load\-String}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Load\-String}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Load\-String (
\begin{DoxyParamCaption}
\item[{string}]{text, }
\item[{string}]{file\-Name = {\ttfamily \char`\"{}$<$input$>$\char`\"{}}, }
\item[{bool}]{show\-Tokens = {\ttfamily false}, }
\item[{bool}]{show\-Parse\-Tree = {\ttfamily false}, }
\item[{string}]{only\-Consider\-Node = {\ttfamily null}}
\end{DoxyParamCaption}
)}}\label{a00082_a7b66187877ec8a2bfee2298d3dd16706}


Ask the loader to parse a string. 

Returns the number of nodes that were loaded. 

Definition at line 344 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-library, Yarn.\-Dialogue.\-Log\-Debug\-Message, Yarn.\-Dialogue.\-Log\-Error\-Message, and Yarn.\-Dialogue.\-program.



Referenced by Yarn.\-Dialogue.\-Load\-File().


\begin{DoxyCode}
344                                                                                                            
                                                 \{
345 
346             \textcolor{keywordflow}{if} (\hyperlink{a00082_a381f48bb0fbb294f8cf44ca57f11be31}{LogDebugMessage} == null) \{
347                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} YarnException (\textcolor{stringliteral}{"LogDebugMessage must be set before loading"});
348             \}
349 
350             \textcolor{keywordflow}{if} (\hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} == null) \{
351                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} YarnException (\textcolor{stringliteral}{"LogErrorMessage must be set before loading"});
352             \}
353 
354             \textcolor{comment}{// Try to infer the type}
355 
356             \hyperlink{a00041_ad7ebb46e7309ead8767383a672b3272f}{NodeFormat} format;
357 
358             \textcolor{keywordflow}{if} (text.StartsWith(\textcolor{stringliteral}{"["}, StringComparison.Ordinal)) \{
359                 \textcolor{comment}{// starts with a \{? this is probably a JSON array}
360                 format = NodeFormat.JSON;
361             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (text.Contains(\textcolor{stringliteral}{"---"})) \{
362                 \textcolor{comment}{// contains a --- delimiter? probably multi node text}
363                 format = NodeFormat.Text;
364             \} \textcolor{keywordflow}{else} \{
365                 \textcolor{comment}{// fall back to the single node format}
366                 format = NodeFormat.SingleNodeText;
367             \}
368 
369             \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program} = loader.Load(text, \hyperlink{a00082_ae660d4cfb6e296358d2f61d8ee74c66a}{library}, fileName, \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}, showTokens, 
      showParseTree, onlyConsiderNode, format, this.experimentalMode);
370 
371         \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a7b66187877ec8a2bfee2298d3dd16706_icgraph}
\end{center}
\end{figure}


\hypertarget{a00082_a93bb76a1f9a4058f225ff4cee97483c6}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Node\-Exists@{Node\-Exists}}
\index{Node\-Exists@{Node\-Exists}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Node\-Exists}]{\setlength{\rightskip}{0pt plus 5cm}bool Yarn.\-Dialogue.\-Node\-Exists (
\begin{DoxyParamCaption}
\item[{string}]{node\-Name}
\end{DoxyParamCaption}
)}}\label{a00082_a93bb76a1f9a4058f225ff4cee97483c6}


Definition at line 567 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Log\-Debug\-Message, Yarn.\-Dialogue.\-Log\-Error\-Message, Yarn.\-Program.\-nodes, and Yarn.\-Dialogue.\-program.



Referenced by Yarn.\-Dialogue.\-Yarn\-Function\-Node\-Visit\-Count().


\begin{DoxyCode}
567                                                 \{
568             \textcolor{keywordflow}{if} (\hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program} == null) \{
569 
570                 \textcolor{keywordflow}{if} (\hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}.\hyperlink{a00142_a3f4928a577c88263ad016be259b175c4}{nodes}.Count > 0) \{
571                     \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} (\textcolor{stringliteral}{"Internal consistency error: Called NodeExists, and "} +
572                                      \textcolor{stringliteral}{"there are nodes loaded, but the program hasn't "} +
573                                      \textcolor{stringliteral}{"been compiled yet, somehow?"});
574 
575                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
576 
577                 \} \textcolor{keywordflow}{else} \{
578                     \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} (\textcolor{stringliteral}{"Tried to call NodeExists, but no nodes "} +
579                                      \textcolor{stringliteral}{"have been compiled!"});
580                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
581                 \}
582             \}
583             \textcolor{keywordflow}{if} (\hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}.\hyperlink{a00142_a3f4928a577c88263ad016be259b175c4}{nodes} == null || \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program}.\hyperlink{a00142_a3f4928a577c88263ad016be259b175c4}{nodes}.Count == 0) \{
584                 \hyperlink{a00082_a381f48bb0fbb294f8cf44ca57f11be31}{LogDebugMessage} (\textcolor{stringliteral}{"Called NodeExists, but there are zero nodes. "} +
585                                  \textcolor{stringliteral}{"This may be an error."});
586                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
587             \}
588             \textcolor{keywordflow}{return} program.nodes.ContainsKey(nodeName);
589         \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a93bb76a1f9a4058f225ff4cee97483c6_icgraph}
\end{center}
\end{figure}


\hypertarget{a00082_aead84ee50cb113ca45724894290ce9c2}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Run@{Run}}
\index{Run@{Run}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Run}]{\setlength{\rightskip}{0pt plus 5cm}I\-Enumerable$<${\bf Yarn.\-Dialogue.\-Runner\-Result}$>$ Yarn.\-Dialogue.\-Run (
\begin{DoxyParamCaption}
\item[{string}]{start\-Node = {\ttfamily {\bf D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T}}}
\end{DoxyParamCaption}
)}}\label{a00082_aead84ee50cb113ca45724894290ce9c2}


Use this in a for-\/each construct; each time you iterate over it, you'll get a line, command, or set of options. 



Definition at line 379 of file Dialogue.\-cs.



References Yarn.\-Virtual\-Machine.\-execution\-State, Yarn.\-Dialogue.\-Log\-Debug\-Message, Yarn.\-Dialogue.\-Log\-Error\-Message, Yarn.\-Dialogue.\-program, Yarn.\-Virtual\-Machine.\-Set\-Node(), Yarn.\-Dialogue.\-visited\-Node\-Count, and Yarn.\-Dialogue.\-vm.



Referenced by Yarn.\-Yarn\-Spinner\-Console.\-Run().


\begin{DoxyCode}
379                                                                                              \{
380 
381             \textcolor{keywordflow}{if} (\hyperlink{a00082_a381f48bb0fbb294f8cf44ca57f11be31}{LogDebugMessage} == null) \{
382                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} YarnException (\textcolor{stringliteral}{"LogDebugMessage must be set before running"});
383             \}
384 
385             \textcolor{keywordflow}{if} (\hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} == null) \{
386                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} YarnException (\textcolor{stringliteral}{"LogErrorMessage must be set before running"});
387             \}
388 
389             \textcolor{keywordflow}{if} (\hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program} == null) \{
390                 \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} (\textcolor{stringliteral}{"Dialogue.Run was called, but no program was loaded.
       Stopping."});
391                 yield \textcolor{keywordflow}{break};
392             \}
393 
394             \hyperlink{a00082_a8c1319357a9df6cff051328fb33224c7}{vm} = \textcolor{keyword}{new} VirtualMachine (\textcolor{keyword}{this}, \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program});
395 
396             RunnerResult latestResult;
397 
398             vm.lineHandler = delegate(LineResult result) \{
399                 latestResult = result;
400             \};
401 
402             vm.commandHandler = delegate(CommandResult result) \{
403                 \textcolor{comment}{// Is it the special custom command "<<stop>>"?}
404                 \textcolor{keywordflow}{if} (result is CommandResult && (result as CommandResult).command.text == \textcolor{stringliteral}{"stop"}) \{
405                     vm.Stop();
406                 \}
407                 latestResult = result;
408             \};
409 
410             vm.nodeCompleteHandler = delegate(NodeCompleteResult result) \{
411 
412                 \textcolor{comment}{// get the count if it's there, otherwise it defaults to 0}
413                 \textcolor{keywordtype}{int} count = 0;
414                 visitedNodeCount.TryGetValue(vm.currentNodeName, out count);
415 
416                 \hyperlink{a00082_aae9e64354066a1e2fa130629959d772b}{visitedNodeCount}[vm.currentNodeName] = count + 1;
417                 latestResult = result;
418             \};
419 
420             vm.optionsHandler = delegate(OptionSetResult result) \{
421                 latestResult = result;
422             \};
423 
424             \textcolor{keywordflow}{if} (\hyperlink{a00082_a8c1319357a9df6cff051328fb33224c7}{vm}.\hyperlink{a00152_a6364593ea1115d65e34b343422cfbbbd}{SetNode} (startNode) == \textcolor{keyword}{false}) \{
425                 yield \textcolor{keywordflow}{break};
426             \}
427 
428             \textcolor{comment}{// Run until the program stops, pausing to yield important}
429             \textcolor{comment}{// results}
430             \textcolor{keywordflow}{do} \{
431 
432                 latestResult = null;
433                 vm.RunNext ();
434                 \textcolor{keywordflow}{if} (latestResult != null)
435                     yield \textcolor{keywordflow}{return} latestResult;
436 
437             \} \textcolor{keywordflow}{while} (\hyperlink{a00082_a8c1319357a9df6cff051328fb33224c7}{vm}.\hyperlink{a00152_a66491da06023dabfb63d09e6ccbba74f}{executionState} != VirtualMachine.ExecutionState.Stopped);
438 
439         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_aead84ee50cb113ca45724894290ce9c2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_aead84ee50cb113ca45724894290ce9c2_icgraph}
\end{center}
\end{figure}


\hypertarget{a00082_a7a6cabe5612fdcdc4619460431f85112}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Stop@{Stop}}
\index{Stop@{Stop}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Stop}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Stop (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{a00082_a7a6cabe5612fdcdc4619460431f85112}


Definition at line 441 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-vm.


\begin{DoxyCode}
441                            \{
442             \textcolor{keywordflow}{if} (\hyperlink{a00082_a8c1319357a9df6cff051328fb33224c7}{vm} != null)
443                 vm.Stop();
444         \}
\end{DoxyCode}
\hypertarget{a00082_a7acfe32f91b36ee812059f2ad3011133}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Unload\-All@{Unload\-All}}
\index{Unload\-All@{Unload\-All}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Unload\-All}]{\setlength{\rightskip}{0pt plus 5cm}void Yarn.\-Dialogue.\-Unload\-All (
\begin{DoxyParamCaption}
\item[{bool}]{clear\-Visited\-Nodes = {\ttfamily true}}
\end{DoxyParamCaption}
)}}\label{a00082_a7acfe32f91b36ee812059f2ad3011133}


Unloads A\-L\-L nodes. 



Definition at line 550 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-program.


\begin{DoxyCode}
550                                                              \{
551             \textcolor{keywordflow}{if} (clearVisitedNodes)
552                 visitedNodeCount.Clear();
553 
554             \hyperlink{a00082_a0a1cca92325f430425d784d416cb5c2b}{program} = null;
555 
556         \}
\end{DoxyCode}
\hypertarget{a00082_a1ab129bd84381928531d503304ca08d6}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Yarn\-Function\-Is\-Node\-Visited@{Yarn\-Function\-Is\-Node\-Visited}}
\index{Yarn\-Function\-Is\-Node\-Visited@{Yarn\-Function\-Is\-Node\-Visited}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Yarn\-Function\-Is\-Node\-Visited}]{\setlength{\rightskip}{0pt plus 5cm}object Yarn.\-Dialogue.\-Yarn\-Function\-Is\-Node\-Visited (
\begin{DoxyParamCaption}
\item[{{\bf Value}\mbox{[}$\,$\mbox{]}}]{parameters}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{a00082_a1ab129bd84381928531d503304ca08d6}


A \hyperlink{a00041}{Yarn} function that returns true if the named node, or the current node if no parameters were provided, has been visited at least once. 



Definition at line 241 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Yarn\-Function\-Node\-Visit\-Count().



Referenced by Yarn.\-Dialogue.\-Dialogue().


\begin{DoxyCode}
242         \{
243             \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})\hyperlink{a00082_a10c9f22d3f55e74f091cd6069c431094}{YarnFunctionNodeVisitCount}(parameters) > 0;
244         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a1ab129bd84381928531d503304ca08d6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a1ab129bd84381928531d503304ca08d6_icgraph}
\end{center}
\end{figure}


\hypertarget{a00082_a10c9f22d3f55e74f091cd6069c431094}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Yarn\-Function\-Node\-Visit\-Count@{Yarn\-Function\-Node\-Visit\-Count}}
\index{Yarn\-Function\-Node\-Visit\-Count@{Yarn\-Function\-Node\-Visit\-Count}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Yarn\-Function\-Node\-Visit\-Count}]{\setlength{\rightskip}{0pt plus 5cm}object Yarn.\-Dialogue.\-Yarn\-Function\-Node\-Visit\-Count (
\begin{DoxyParamCaption}
\item[{{\bf Value}\mbox{[}$\,$\mbox{]}}]{parameters}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{a00082_a10c9f22d3f55e74f091cd6069c431094}


A function exposed to \hyperlink{a00041}{Yarn} that returns the number of times a node has been run. 

If no parameters are supplied, returns the number of time the current node has been run. 

Definition at line 207 of file Dialogue.\-cs.



References Yarn.\-Dialogue.\-Log\-Error\-Message, and Yarn.\-Dialogue.\-Node\-Exists().



Referenced by Yarn.\-Dialogue.\-Dialogue(), and Yarn.\-Dialogue.\-Yarn\-Function\-Is\-Node\-Visited().


\begin{DoxyCode}
208         \{
209             \textcolor{comment}{// Determine the node we're checking}
210             \textcolor{keywordtype}{string} nodeName;
211 
212             \textcolor{keywordflow}{if} (parameters.Length == 0) \{
213                 \textcolor{comment}{// No parameters? Check the current node}
214                 nodeName = vm.currentNodeName;
215             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (parameters.Length == 1) \{
216                 \textcolor{comment}{// A parameter? Check the named node}
217                 nodeName = parameters [0].AsString;
218 
219                 \textcolor{comment}{// Ensure this node exists}
220                 \textcolor{keywordflow}{if} (\hyperlink{a00082_a93bb76a1f9a4058f225ff4cee97483c6}{NodeExists} (nodeName) == \textcolor{keyword}{false}) \{
221                     var errorMessage = string.Format (\textcolor{stringliteral}{"The node \{0\} does not "} + \textcolor{stringliteral}{"exist."}, nodeName);
222                     \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} (errorMessage);
223                     \textcolor{keywordflow}{return} 0;
224                 \}
225             \} \textcolor{keywordflow}{else} \{
226                 \textcolor{comment}{// We got too many parameters}
227                 var errorMessage = string.Format (\textcolor{stringliteral}{"Incorrect number of parameters to "} + \textcolor{stringliteral}{"visitCount
       (expected 0 or 1, got \{0\})"}, parameters.Length);
228                 \hyperlink{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{LogErrorMessage} (errorMessage);
229                 \textcolor{keywordflow}{return} 0;
230             \}
231 
232             \textcolor{comment}{// Figure out how many times this node was run}
233             \textcolor{keywordtype}{int} visitCount = 0;
234             visitedNodeCount.TryGetValue (nodeName, out visitCount);
235 
236             \textcolor{keywordflow}{return} visitCount;
237         \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a10c9f22d3f55e74f091cd6069c431094_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00082_a10c9f22d3f55e74f091cd6069c431094_icgraph}
\end{center}
\end{figure}




\subsection{Member Data Documentation}
\hypertarget{a00082_ae94eaa4b03b432422f5d205fabe37ff5}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!continuity@{continuity}}
\index{continuity@{continuity}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{continuity}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Variable\-Storage} Yarn.\-Dialogue.\-continuity\hspace{0.3cm}{\ttfamily [package]}}}\label{a00082_ae94eaa4b03b432422f5d205fabe37ff5}


Definition at line 125 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Dialogue(), and Yarn.\-Virtual\-Machine.\-Run\-Instruction().

\hypertarget{a00082_a1b643f15f734090e6a58cbf13dafd28f}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T@{D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T}}
\index{D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T@{D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}const string Yarn.\-Dialogue.\-D\-E\-F\-A\-U\-L\-T\-\_\-\-S\-T\-A\-R\-T = \char`\"{}Start\char`\"{}}}\label{a00082_a1b643f15f734090e6a58cbf13dafd28f}


The node we start from. 



Definition at line 189 of file Dialogue.\-cs.

\hypertarget{a00082_a2a5ac23441861eef13c59044cc218f09}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!experimental\-Mode@{experimental\-Mode}}
\index{experimental\-Mode@{experimental\-Mode}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{experimental\-Mode}]{\setlength{\rightskip}{0pt plus 5cm}bool Yarn.\-Dialogue.\-experimental\-Mode = false}}\label{a00082_a2a5ac23441861eef13c59044cc218f09}


We'll ask this object for the state of variables. 



Definition at line 127 of file Dialogue.\-cs.

\hypertarget{a00082_a3bc83587462ade6a2f7f42cb7576e50e}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T@{L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T}}
\index{L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T@{L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Compiled\-Format} Yarn.\-Dialogue.\-L\-A\-T\-E\-S\-T\-\_\-\-F\-O\-R\-M\-A\-T = Compiled\-Format.\-V1}}\label{a00082_a3bc83587462ade6a2f7f42cb7576e50e}


Definition at line 521 of file Dialogue.\-cs.

\hypertarget{a00082_ae660d4cfb6e296358d2f61d8ee74c66a}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!library@{library}}
\index{library@{library}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{library}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Library} Yarn.\-Dialogue.\-library}}\label{a00082_ae660d4cfb6e296358d2f61d8ee74c66a}


The library contains all of the functions and operators we know about. 



Definition at line 198 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Compile(), Yarn.\-Dialogue.\-Dialogue(), Yarn.\-Dialogue.\-Get\-Byte\-Code(), Yarn.\-Dialogue.\-Load\-String(), and Yarn.\-Virtual\-Machine.\-Run\-Instruction().

\hypertarget{a00082_a98bbe0ac2ccadeeeb7e05e3e6e19f2e0}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!loader@{loader}}
\index{loader@{loader}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{loader}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Loader} Yarn.\-Dialogue.\-loader\hspace{0.3cm}{\ttfamily [package]}}}\label{a00082_a98bbe0ac2ccadeeeb7e05e3e6e19f2e0}


The loader contains all of the nodes we're going to run. 



Definition at line 192 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Dialogue().

\hypertarget{a00082_a381f48bb0fbb294f8cf44ca57f11be31}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Log\-Debug\-Message@{Log\-Debug\-Message}}
\index{Log\-Debug\-Message@{Log\-Debug\-Message}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Log\-Debug\-Message}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Logger} Yarn.\-Dialogue.\-Log\-Debug\-Message}}\label{a00082_a381f48bb0fbb294f8cf44ca57f11be31}


Delegates used for logging. 



Definition at line 185 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Load\-Compiled\-Program(), Yarn.\-Dialogue.\-Load\-String(), Yarn.\-Dialogue.\-Node\-Exists(), and Yarn.\-Dialogue.\-Run().

\hypertarget{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!Log\-Error\-Message@{Log\-Error\-Message}}
\index{Log\-Error\-Message@{Log\-Error\-Message}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{Log\-Error\-Message}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Logger} Yarn.\-Dialogue.\-Log\-Error\-Message}}\label{a00082_a9801e83dd044d6498fdf6ebcc6bec5ac}


Definition at line 186 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Get\-Text\-For\-Node(), Yarn.\-Dialogue.\-Load\-Compiled\-Program(), Yarn.\-Dialogue.\-Load\-Compiled\-Program\-V1(), Yarn.\-Dialogue.\-Load\-String(), Yarn.\-Dialogue.\-Node\-Exists(), Yarn.\-Dialogue.\-Run(), and Yarn.\-Dialogue.\-Yarn\-Function\-Node\-Visit\-Count().

\hypertarget{a00082_a0a1cca92325f430425d784d416cb5c2b}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!program@{program}}
\index{program@{program}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{program}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Program} Yarn.\-Dialogue.\-program\hspace{0.3cm}{\ttfamily [package]}}}\label{a00082_a0a1cca92325f430425d784d416cb5c2b}


The \hyperlink{a00142}{Program} is the compiled \hyperlink{a00041}{Yarn} program. 



Definition at line 195 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Get\-Text\-For\-All\-Nodes(), Yarn.\-Dialogue.\-Get\-Text\-For\-Node(), Yarn.\-Dialogue.\-Load\-Compiled\-Program\-V1(), Yarn.\-Dialogue.\-Load\-String(), Yarn.\-Dialogue.\-Node\-Exists(), Yarn.\-Dialogue.\-Run(), and Yarn.\-Dialogue.\-Unload\-All().

\hypertarget{a00082_aae9e64354066a1e2fa130629959d772b}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!visited\-Node\-Count@{visited\-Node\-Count}}
\index{visited\-Node\-Count@{visited\-Node\-Count}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{visited\-Node\-Count}]{\setlength{\rightskip}{0pt plus 5cm}Dictionary$<${\bf String}, int$>$ Yarn.\-Dialogue.\-visited\-Node\-Count = new Dictionary$<$string, int$>$()}}\label{a00082_aae9e64354066a1e2fa130629959d772b}


The collection of nodes that we've seen. 



Definition at line 201 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Run().

\hypertarget{a00082_a8c1319357a9df6cff051328fb33224c7}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!vm@{vm}}
\index{vm@{vm}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{vm}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Virtual\-Machine} Yarn.\-Dialogue.\-vm\hspace{0.3cm}{\ttfamily [private]}}}\label{a00082_a8c1319357a9df6cff051328fb33224c7}


Definition at line 373 of file Dialogue.\-cs.



Referenced by Yarn.\-Dialogue.\-Run(), and Yarn.\-Dialogue.\-Stop().



\subsection{Property Documentation}
\hypertarget{a00082_a0ee573e3d072bccf98ba1d975612d42c}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!all\-Nodes@{all\-Nodes}}
\index{all\-Nodes@{all\-Nodes}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{all\-Nodes}]{\setlength{\rightskip}{0pt plus 5cm}I\-Enumerable$<$string$>$ Yarn.\-Dialogue.\-all\-Nodes\hspace{0.3cm}{\ttfamily [get]}}}\label{a00082_a0ee573e3d072bccf98ba1d975612d42c}


Definition at line 458 of file Dialogue.\-cs.

\hypertarget{a00082_af368b5c342d585dc6953876c5965ccc8}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!current\-Node@{current\-Node}}
\index{current\-Node@{current\-Node}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{current\-Node}]{\setlength{\rightskip}{0pt plus 5cm}string Yarn.\-Dialogue.\-current\-Node\hspace{0.3cm}{\ttfamily [get]}}}\label{a00082_af368b5c342d585dc6953876c5965ccc8}


Definition at line 464 of file Dialogue.\-cs.

\hypertarget{a00082_ac5661051e0b7f44527fe526c7766dbbf}{\index{Yarn\-::\-Dialogue@{Yarn\-::\-Dialogue}!visited\-Nodes@{visited\-Nodes}}
\index{visited\-Nodes@{visited\-Nodes}!Yarn::Dialogue@{Yarn\-::\-Dialogue}}
\subsubsection[{visited\-Nodes}]{\setlength{\rightskip}{0pt plus 5cm}I\-Enumerable$<$string$>$ Yarn.\-Dialogue.\-visited\-Nodes\hspace{0.3cm}{\ttfamily [get]}, {\ttfamily [set]}}}\label{a00082_ac5661051e0b7f44527fe526c7766dbbf}


Definition at line 446 of file Dialogue.\-cs.



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
Yarn\-Spinner/\hyperlink{a00290}{Dialogue.\-cs}\end{DoxyCompactItemize}
